[2022-08-10 15:22:52,957] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:22:52,998] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 26 and epoch zk version is now 26 (kafka.controller.KafkaController)
[2022-08-10 15:22:53,003] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-08-10 15:22:53,010] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-08-10 15:22:53,022] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-08-10 15:22:53,026] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-08-10 15:22:53,060] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 2143) (kafka.controller.KafkaController)
[2022-08-10 15:22:53,105] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:22:53,210] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:22:53,223] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:22:53,223] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:22:53,224] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 15:22:53,226] INFO [Controller id=0] Current list of topics in the cluster: HashSet(test-topic, library-events, __consumer_offsets, test-topic-SSL) (kafka.controller.KafkaController)
[2022-08-10 15:22:53,226] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-08-10 15:22:53,242] INFO [Controller id=0] List of topics to be deleted: test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:22:53,242] INFO [Controller id=0] List of topics ineligible for deletion: library-events,test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:22:53,242] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-08-10 15:22:53,243] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(test-topic-SSL), initial ineligible deletions: HashSet(library-events, test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:22:53,247] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-08-10 15:22:53,261] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:22:53,279] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:22:53,280] INFO [RequestSendThread controllerId=0] Controller 0 connected to DESKTOP-TNJ4TGT:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:22:53,361] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:22:53,458] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=1,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=0,Replica=2] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:22:53,458] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:22:53,467] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:22:53,689] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, test-topic-SSL-0 -> OfflinePartition, library-events-2 -> OfflinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, test-topic-2 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, library-events-1 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, test-topic-SSL-1 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, test-topic-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, test-topic-SSL-2 -> OfflinePartition, library-events-0 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, test-topic-0 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, test-topic-3 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:22:53,690] INFO [Controller id=0] Ready to serve as the new controller with epoch 26 (kafka.controller.KafkaController)
[2022-08-10 15:22:53,693] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:22:53,699] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:22:53,699] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:22:53,700] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-08-10 15:22:53,700] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-08-10 15:22:53,702] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-08-10 15:22:53,715] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-08-10 15:22:58,720] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:22:58,721] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:22:58,726] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(library-events-0 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2022-08-10 15:22:58,727] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.01818181818181818 (kafka.controller.KafkaController)
[2022-08-10 15:22:58,727] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:22:58,727] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:22:58,728] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:22:58,729] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:22:58,729] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:22:58,729] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:24:18,474] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-08-10 15:24:18,474] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2022-08-10 15:24:18,474] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-08-10 15:24:18,490] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-9 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-42 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-SSL-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:26),library-events-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:41,ZkVersion:57,ControllerEpoch:26),__consumer_offsets-21 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-17 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-30 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-26 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-5 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-38 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-45 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-12 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-41 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),library-events-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:42,ZkVersion:58,ControllerEpoch:26),__consumer_offsets-24 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-20 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-SSL-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:26),__consumer_offsets-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-29 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-8 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-33 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-15 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-48 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-11 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-44 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-23 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-SSL-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:26),library-events-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:34,ZkVersion:50,ControllerEpoch:26),__consumer_offsets-32 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-36 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-47 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-14 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-18 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),test-topic-3 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-27 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-39 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-6 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-35 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26),__consumer_offsets-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:19,ControllerEpoch:26) (kafka.controller.KafkaController)
[2022-08-10 15:24:18,705] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:24:18,705] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:24:18,705] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:24:18,706] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-08-10 15:24:18,707] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:24:18,709] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:24:18,711] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:24:18,712] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-08-10 15:24:18,712] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-08-10 15:24:18,712] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-08-10 15:24:18,714] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2022-08-10 15:32:10,566] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:32:10,609] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 27 and epoch zk version is now 27 (kafka.controller.KafkaController)
[2022-08-10 15:32:10,613] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-08-10 15:32:10,620] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-08-10 15:32:10,628] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-08-10 15:32:10,633] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-08-10 15:32:10,660] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 2222) (kafka.controller.KafkaController)
[2022-08-10 15:32:10,687] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:32:10,851] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:32:10,868] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:32:10,868] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 15:32:10,869] INFO [Controller id=0] Current list of topics in the cluster: HashSet(test-topic, library-events, __consumer_offsets, test-topic-SSL) (kafka.controller.KafkaController)
[2022-08-10 15:32:10,869] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-08-10 15:32:10,877] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:32:10,887] INFO [Controller id=0] List of topics to be deleted: test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:32:10,887] INFO [Controller id=0] List of topics ineligible for deletion: library-events,test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:32:10,888] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-08-10 15:32:10,889] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(test-topic-SSL), initial ineligible deletions: HashSet(library-events, test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:10,897] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-08-10 15:32:10,913] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:32:10,929] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:32:10,933] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:32:10,985] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:32:11,057] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=1,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=0,Replica=2] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:32:11,059] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:32:11,081] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:32:11,147] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, test-topic-SSL-0 -> OfflinePartition, library-events-2 -> OfflinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, test-topic-2 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, library-events-1 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, test-topic-SSL-1 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, test-topic-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, test-topic-SSL-2 -> OfflinePartition, library-events-0 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, test-topic-0 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, test-topic-3 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:32:11,148] INFO [Controller id=0] Ready to serve as the new controller with epoch 27 (kafka.controller.KafkaController)
[2022-08-10 15:32:11,151] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:11,157] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:32:11,158] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:32:11,158] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-08-10 15:32:11,159] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-08-10 15:32:11,161] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-08-10 15:32:11,178] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-08-10 15:32:16,194] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:32:16,194] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:32:16,204] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(library-events-0 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2022-08-10 15:32:16,205] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.01818181818181818 (kafka.controller.KafkaController)
[2022-08-10 15:32:16,205] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:32:16,205] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:32:16,207] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:32:16,207] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:32:16,207] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:32:16,207] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:32:55,366] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2022-08-10 15:32:55,368] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:32:55,374] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:32:55,374] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2022-08-10 15:32:55,383] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:32:55,398] INFO [Controller id=0] Some replicas [Topic=test-topic-SSL,Partition=1,Replica=1],[Topic=test-topic-SSL,Partition=2,Replica=1],[Topic=test-topic-SSL,Partition=0,Replica=1] for topics scheduled for deletion test-topic-SSL are on the newly restarted brokers 1. Signaling restart of topic deletion for these topics (kafka.controller.KafkaController)
[2022-08-10 15:32:55,399] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,401] INFO [Topic Deletion Manager 0] Deletion of topic test-topic-SSL (re)started (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,409] DEBUG [Topic Deletion Manager 0] Dead Replicas ([Topic=test-topic-SSL,Partition=1,Replica=2],[Topic=test-topic-SSL,Partition=2,Replica=2],[Topic=test-topic-SSL,Partition=0,Replica=2]) found for topic test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,425] INFO [Topic Deletion Manager 0] Halted deletion of topics test-topic-SSL due to offline replicas (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,425] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2022-08-10 15:32:55,426] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2222, 1 -> 2246) (kafka.controller.KafkaController)
[2022-08-10 15:32:55,471] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(test-topic-SSL-0 -> KAFKA_STORAGE_ERROR, test-topic-SSL-2 -> KAFKA_STORAGE_ERROR, test-topic-SSL-1 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2022-08-10 15:32:55,473] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=test-topic-SSL,Partition=0,Replica=0],[Topic=test-topic-SSL,Partition=2,Replica=0],[Topic=test-topic-SSL,Partition=1,Replica=0]. Halting deletion for topics Set(test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,474] INFO [Topic Deletion Manager 0] Halted deletion of topics test-topic-SSL due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,474] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:32:55,512] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:32:55,540] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-08-10 15:33:15,657] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 28 and epoch zk version is now 28 (kafka.controller.KafkaController)
[2022-08-10 15:33:15,659] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2022-08-10 15:33:15,662] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-08-10 15:33:15,666] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-08-10 15:33:15,669] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2022-08-10 15:33:15,677] INFO [Controller id=1] Initialized broker epochs cache: HashMap(1 -> 2246) (kafka.controller.KafkaController)
[2022-08-10 15:33:15,690] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2022-08-10 15:33:15,731] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:33:15,738] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:33:15,740] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2022-08-10 15:33:15,740] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 15:33:15,741] INFO [Controller id=1] Current list of topics in the cluster: HashSet(test-topic, library-events, __consumer_offsets, test-topic-SSL) (kafka.controller.KafkaController)
[2022-08-10 15:33:15,741] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-08-10 15:33:15,747] INFO [Controller id=1] List of topics to be deleted: test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:33:15,747] INFO [Controller id=1] List of topics ineligible for deletion: library-events,test-topic,__consumer_offsets,test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:33:15,748] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-08-10 15:33:15,749] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(test-topic-SSL), initial ineligible deletions: HashSet(library-events, test-topic, __consumer_offsets, test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:33:15,751] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2022-08-10 15:33:15,760] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:33:15,762] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:33:15,770] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:33:15,789] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:33:15,989] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=2,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=1,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=2] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=0,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:33:15,990] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:33:15,997] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:33:16,085] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, test-topic-SSL-0 -> OfflinePartition, library-events-2 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, test-topic-2 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, library-events-1 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, test-topic-SSL-1 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, test-topic-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, test-topic-SSL-2 -> OfflinePartition, library-events-0 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, test-topic-0 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, test-topic-3 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:33:16,085] INFO [Controller id=1] Ready to serve as the new controller with epoch 28 (kafka.controller.KafkaController)
[2022-08-10 15:33:16,088] INFO [Topic Deletion Manager 1] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:33:16,092] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:33:16,092] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:33:16,092] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-08-10 15:33:16,093] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-08-10 15:33:16,094] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-08-10 15:33:16,101] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-08-10 15:33:21,117] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:33:21,118] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:33:21,121] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 15:33:21,123] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:33:21,125] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:33:21,126] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:33:21,126] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:33:21,126] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:33:21,126] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:33:21,126] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:33:21,126] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:38:21,131] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:38:21,131] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:38:21,133] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 15:38:21,133] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:38:21,134] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:38:21,135] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:38:21,135] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:38:21,135] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:38:21,135] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:38:21,135] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:38:21,135] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:43:21,140] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:43:21,140] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:43:21,141] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 15:43:21,142] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:43:21,142] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:43:21,142] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:43:21,143] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:43:21,143] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:43:21,143] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:43:21,143] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:43:21,143] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:47:39,326] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2022-08-10 15:47:39,326] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2022-08-10 15:47:39,327] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2022-08-10 15:47:39,336] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:48:34,785] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:48:34,831] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 29 and epoch zk version is now 29 (kafka.controller.KafkaController)
[2022-08-10 15:48:34,835] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-08-10 15:48:34,841] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-08-10 15:48:34,850] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-08-10 15:48:34,859] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-08-10 15:48:34,884] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 2326) (kafka.controller.KafkaController)
[2022-08-10 15:48:34,942] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:48:35,045] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:48:35,072] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-08-10 15:48:35,073] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 15:48:35,073] INFO [Controller id=0] Current list of topics in the cluster: HashSet(test-topic, library-events, __consumer_offsets, test-topic-SSL) (kafka.controller.KafkaController)
[2022-08-10 15:48:35,074] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-08-10 15:48:35,086] INFO [Controller id=0] List of topics to be deleted: test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:48:35,087] INFO [Controller id=0] List of topics ineligible for deletion: library-events,test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:48:35,087] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-08-10 15:48:35,088] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(test-topic-SSL), initial ineligible deletions: HashSet(library-events, test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:35,092] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:48:35,093] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-08-10 15:48:35,116] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:48:35,132] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:48:35,139] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:48:35,176] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:48:35,251] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=1,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=1] -> OfflineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OnlineReplica, [Topic=library-events,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OnlineReplica, [Topic=test-topic-SSL,Partition=0,Replica=2] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=0,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=3,Replica=0] -> OnlineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OnlineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:48:35,251] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:48:35,257] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:48:35,488] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OnlinePartition, __consumer_offsets-46 -> OnlinePartition, __consumer_offsets-9 -> OnlinePartition, __consumer_offsets-42 -> OnlinePartition, test-topic-SSL-0 -> OfflinePartition, library-events-2 -> OfflinePartition, __consumer_offsets-21 -> OnlinePartition, __consumer_offsets-17 -> OnlinePartition, test-topic-2 -> OnlinePartition, __consumer_offsets-30 -> OnlinePartition, __consumer_offsets-26 -> OnlinePartition, __consumer_offsets-5 -> OnlinePartition, __consumer_offsets-38 -> OnlinePartition, __consumer_offsets-1 -> OnlinePartition, __consumer_offsets-34 -> OnlinePartition, __consumer_offsets-16 -> OnlinePartition, __consumer_offsets-45 -> OnlinePartition, __consumer_offsets-12 -> OnlinePartition, __consumer_offsets-41 -> OnlinePartition, library-events-1 -> OfflinePartition, __consumer_offsets-24 -> OnlinePartition, __consumer_offsets-20 -> OnlinePartition, __consumer_offsets-49 -> OnlinePartition, test-topic-SSL-1 -> OfflinePartition, __consumer_offsets-0 -> OnlinePartition, __consumer_offsets-29 -> OnlinePartition, test-topic-1 -> OnlinePartition, __consumer_offsets-25 -> OnlinePartition, __consumer_offsets-8 -> OnlinePartition, __consumer_offsets-37 -> OnlinePartition, __consumer_offsets-4 -> OnlinePartition, __consumer_offsets-33 -> OnlinePartition, __consumer_offsets-15 -> OnlinePartition, __consumer_offsets-48 -> OnlinePartition, __consumer_offsets-11 -> OnlinePartition, __consumer_offsets-44 -> OnlinePartition, __consumer_offsets-23 -> OnlinePartition, __consumer_offsets-19 -> OnlinePartition, test-topic-SSL-2 -> OfflinePartition, library-events-0 -> OfflinePartition, __consumer_offsets-32 -> OnlinePartition, test-topic-0 -> OnlinePartition, __consumer_offsets-28 -> OnlinePartition, __consumer_offsets-7 -> OnlinePartition, __consumer_offsets-40 -> OnlinePartition, __consumer_offsets-3 -> OnlinePartition, __consumer_offsets-36 -> OnlinePartition, __consumer_offsets-47 -> OnlinePartition, __consumer_offsets-14 -> OnlinePartition, __consumer_offsets-43 -> OnlinePartition, __consumer_offsets-10 -> OnlinePartition, __consumer_offsets-22 -> OnlinePartition, __consumer_offsets-18 -> OnlinePartition, __consumer_offsets-31 -> OnlinePartition, test-topic-3 -> OnlinePartition, __consumer_offsets-27 -> OnlinePartition, __consumer_offsets-39 -> OnlinePartition, __consumer_offsets-6 -> OnlinePartition, __consumer_offsets-35 -> OnlinePartition, __consumer_offsets-2 -> OnlinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:48:35,489] INFO [Controller id=0] Ready to serve as the new controller with epoch 29 (kafka.controller.KafkaController)
[2022-08-10 15:48:35,492] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:35,498] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:48:35,498] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:48:35,498] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-08-10 15:48:35,499] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-08-10 15:48:35,500] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-08-10 15:48:35,522] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-08-10 15:48:40,538] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:48:40,539] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:48:40,543] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap(library-events-0 -> List(0, 1, 2)) (kafka.controller.KafkaController)
[2022-08-10 15:48:40,545] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.01818181818181818 (kafka.controller.KafkaController)
[2022-08-10 15:48:40,545] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:48:40,545] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:48:40,547] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:48:40,547] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:48:40,547] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:48:40,547] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:48:52,822] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2022-08-10 15:48:52,823] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:48:52,831] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2022-08-10 15:48:52,854] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:48:52,856] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:48:52,857] INFO [Controller id=0] Some replicas [Topic=test-topic-SSL,Partition=1,Replica=1],[Topic=test-topic-SSL,Partition=2,Replica=1],[Topic=test-topic-SSL,Partition=0,Replica=1] for topics scheduled for deletion test-topic-SSL are on the newly restarted brokers 1. Signaling restart of topic deletion for these topics (kafka.controller.KafkaController)
[2022-08-10 15:48:52,858] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,860] INFO [Topic Deletion Manager 0] Deletion of topic test-topic-SSL (re)started (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,870] DEBUG [Topic Deletion Manager 0] Dead Replicas ([Topic=test-topic-SSL,Partition=1,Replica=2],[Topic=test-topic-SSL,Partition=2,Replica=2],[Topic=test-topic-SSL,Partition=0,Replica=2]) found for topic test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,884] INFO [Topic Deletion Manager 0] Halted deletion of topics test-topic-SSL due to offline replicas (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,884] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2022-08-10 15:48:52,886] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 2326, 1 -> 2404) (kafka.controller.KafkaController)
[2022-08-10 15:48:52,937] DEBUG [Controller id=0] Delete topic callback invoked on StopReplica response received from broker 0: request error = NONE, partition errors = HashMap(test-topic-SSL-0 -> KAFKA_STORAGE_ERROR, test-topic-SSL-2 -> KAFKA_STORAGE_ERROR, test-topic-SSL-1 -> KAFKA_STORAGE_ERROR) (kafka.controller.KafkaController)
[2022-08-10 15:48:52,940] DEBUG [Topic Deletion Manager 0] Deletion failed for replicas [Topic=test-topic-SSL,Partition=0,Replica=0],[Topic=test-topic-SSL,Partition=2,Replica=0],[Topic=test-topic-SSL,Partition=1,Replica=0]. Halting deletion for topics Set(test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,941] INFO [Topic Deletion Manager 0] Halted deletion of topics test-topic-SSL due to replica deletion failure (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,942] INFO [Topic Deletion Manager 0] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:48:52,970] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 15:48:53,003] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-08-10 15:49:12,654] INFO [Controller id=1] 1 successfully elected as the controller. Epoch incremented to 30 and epoch zk version is now 30 (kafka.controller.KafkaController)
[2022-08-10 15:49:12,656] INFO [Controller id=1] Registering handlers (kafka.controller.KafkaController)
[2022-08-10 15:49:12,659] INFO [Controller id=1] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-08-10 15:49:12,662] INFO [Controller id=1] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-08-10 15:49:12,664] INFO [Controller id=1] Initializing controller context (kafka.controller.KafkaController)
[2022-08-10 15:49:12,672] INFO [Controller id=1] Initialized broker epochs cache: HashMap(1 -> 2404) (kafka.controller.KafkaController)
[2022-08-10 15:49:12,686] DEBUG [Controller id=1] Register BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2022-08-10 15:49:12,728] DEBUG [Channel manager on controller 1]: Controller 1 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2022-08-10 15:49:12,736] INFO [RequestSendThread controllerId=1] Starting (kafka.controller.RequestSendThread)
[2022-08-10 15:49:12,737] INFO [Controller id=1] Currently active brokers in the cluster: Set(1) (kafka.controller.KafkaController)
[2022-08-10 15:49:12,737] INFO [Controller id=1] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 15:49:12,738] INFO [Controller id=1] Current list of topics in the cluster: HashSet(test-topic, library-events, __consumer_offsets, test-topic-SSL) (kafka.controller.KafkaController)
[2022-08-10 15:49:12,739] INFO [Controller id=1] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-08-10 15:49:12,744] INFO [Controller id=1] List of topics to be deleted: test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:49:12,745] INFO [Controller id=1] List of topics ineligible for deletion: library-events,test-topic,__consumer_offsets,test-topic-SSL (kafka.controller.KafkaController)
[2022-08-10 15:49:12,745] INFO [Controller id=1] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-08-10 15:49:12,745] INFO [Topic Deletion Manager 1] Initializing manager with initial deletions: Set(test-topic-SSL), initial ineligible deletions: HashSet(library-events, test-topic, __consumer_offsets, test-topic-SSL) (kafka.controller.TopicDeletionManager)
[2022-08-10 15:49:12,748] INFO [Controller id=1] Sending update metadata request (kafka.controller.KafkaController)
[2022-08-10 15:49:12,756] INFO [ReplicaStateMachine controllerId=1] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:49:12,758] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 15:49:12,766] INFO [ReplicaStateMachine controllerId=1] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:49:12,786] INFO [ReplicaStateMachine controllerId=1] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:49:12,977] DEBUG [ReplicaStateMachine controllerId=1] Started replica state machine with initial state -> HashMap([Topic=__consumer_offsets,Partition=40,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=27,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=49,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=47,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=3,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=18,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=44,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=8,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=34,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=25,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=14,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=24,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=36,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=42,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=2,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=45,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=11,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=32,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=12,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=30,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=9,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=39,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=38,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=23,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=19,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=17,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=41,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=37,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=48,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=29,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=10,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=0,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=46,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=0,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=1,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=16,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=5,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=1,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=15,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=4,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=6,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=7,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=43,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=20,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=1,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=2,Replica=1] -> OnlineReplica, [Topic=__consumer_offsets,Partition=31,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=28,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=1,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=26,Replica=0] -> OfflineReplica, [Topic=library-events,Partition=2,Replica=2] -> OfflineReplica, [Topic=__consumer_offsets,Partition=2,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=33,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=22,Replica=0] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=2] -> OfflineReplica, [Topic=test-topic-SSL,Partition=0,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=21,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=13,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=0,Replica=0] -> OfflineReplica, [Topic=test-topic,Partition=3,Replica=0] -> OfflineReplica, [Topic=__consumer_offsets,Partition=35,Replica=0] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 15:49:12,983] INFO [PartitionStateMachine controllerId=1] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:49:12,992] INFO [PartitionStateMachine controllerId=1] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:49:13,073] DEBUG [PartitionStateMachine controllerId=1] Started partition state machine with initial state -> HashMap(__consumer_offsets-13 -> OfflinePartition, __consumer_offsets-46 -> OfflinePartition, __consumer_offsets-9 -> OfflinePartition, __consumer_offsets-42 -> OfflinePartition, test-topic-SSL-0 -> OfflinePartition, library-events-2 -> OfflinePartition, __consumer_offsets-21 -> OfflinePartition, __consumer_offsets-17 -> OfflinePartition, test-topic-2 -> OfflinePartition, __consumer_offsets-30 -> OfflinePartition, __consumer_offsets-26 -> OfflinePartition, __consumer_offsets-5 -> OfflinePartition, __consumer_offsets-38 -> OfflinePartition, __consumer_offsets-1 -> OfflinePartition, __consumer_offsets-34 -> OfflinePartition, __consumer_offsets-16 -> OfflinePartition, __consumer_offsets-45 -> OfflinePartition, __consumer_offsets-12 -> OfflinePartition, __consumer_offsets-41 -> OfflinePartition, library-events-1 -> OfflinePartition, __consumer_offsets-24 -> OfflinePartition, __consumer_offsets-20 -> OfflinePartition, __consumer_offsets-49 -> OfflinePartition, test-topic-SSL-1 -> OfflinePartition, __consumer_offsets-0 -> OfflinePartition, __consumer_offsets-29 -> OfflinePartition, test-topic-1 -> OfflinePartition, __consumer_offsets-25 -> OfflinePartition, __consumer_offsets-8 -> OfflinePartition, __consumer_offsets-37 -> OfflinePartition, __consumer_offsets-4 -> OfflinePartition, __consumer_offsets-33 -> OfflinePartition, __consumer_offsets-15 -> OfflinePartition, __consumer_offsets-48 -> OfflinePartition, __consumer_offsets-11 -> OfflinePartition, __consumer_offsets-44 -> OfflinePartition, __consumer_offsets-23 -> OfflinePartition, __consumer_offsets-19 -> OfflinePartition, test-topic-SSL-2 -> OfflinePartition, library-events-0 -> OfflinePartition, __consumer_offsets-32 -> OfflinePartition, test-topic-0 -> OfflinePartition, __consumer_offsets-28 -> OfflinePartition, __consumer_offsets-7 -> OfflinePartition, __consumer_offsets-40 -> OfflinePartition, __consumer_offsets-3 -> OfflinePartition, __consumer_offsets-36 -> OfflinePartition, __consumer_offsets-47 -> OfflinePartition, __consumer_offsets-14 -> OfflinePartition, __consumer_offsets-43 -> OfflinePartition, __consumer_offsets-10 -> OfflinePartition, __consumer_offsets-22 -> OfflinePartition, __consumer_offsets-18 -> OfflinePartition, __consumer_offsets-31 -> OfflinePartition, test-topic-3 -> OfflinePartition, __consumer_offsets-27 -> OfflinePartition, __consumer_offsets-39 -> OfflinePartition, __consumer_offsets-6 -> OfflinePartition, __consumer_offsets-35 -> OfflinePartition, __consumer_offsets-2 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 15:49:13,074] INFO [Controller id=1] Ready to serve as the new controller with epoch 30 (kafka.controller.KafkaController)
[2022-08-10 15:49:13,076] INFO [Topic Deletion Manager 1] Handling deletion for topics test-topic-SSL (kafka.controller.TopicDeletionManager)
[2022-08-10 15:49:13,080] INFO [Controller id=1] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:49:13,080] INFO [Controller id=1] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 15:49:13,081] INFO [Controller id=1] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-08-10 15:49:13,081] INFO [Controller id=1] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-08-10 15:49:13,082] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-08-10 15:49:13,092] INFO [Controller id=1] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-08-10 15:49:18,109] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:49:18,110] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:49:18,115] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 15:49:18,116] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:49:18,118] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:54:18,135] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:54:18,135] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:54:18,137] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 15:54:18,137] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:54:18,138] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:59:18,147] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 15:59:18,147] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 15:59:18,151] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 15:59:18,151] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:59:18,153] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:59:18,153] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 15:59:18,153] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:59:18,153] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 15:59:18,153] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 15:59:18,153] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 15:59:18,154] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:04:18,161] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 16:04:18,164] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 16:04:18,171] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 16:04:18,172] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 16:04:18,173] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:09:18,189] INFO [Controller id=1] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 16:09:18,189] TRACE [Controller id=1] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 16:09:18,194] DEBUG [Controller id=1] Topics not in preferred replica for broker 0 HashMap(__consumer_offsets-22 -> List(0), __consumer_offsets-30 -> List(0), __consumer_offsets-25 -> List(0), __consumer_offsets-35 -> List(0), test-topic-2 -> List(0), __consumer_offsets-37 -> List(0), __consumer_offsets-13 -> List(0), test-topic-0 -> List(0), __consumer_offsets-8 -> List(0), __consumer_offsets-21 -> List(0), __consumer_offsets-4 -> List(0), __consumer_offsets-27 -> List(0), __consumer_offsets-7 -> List(0), library-events-0 -> List(0, 1, 2), __consumer_offsets-9 -> List(0), __consumer_offsets-46 -> List(0), __consumer_offsets-41 -> List(0), __consumer_offsets-33 -> List(0), __consumer_offsets-23 -> List(0), __consumer_offsets-49 -> List(0), __consumer_offsets-47 -> List(0), __consumer_offsets-16 -> List(0), __consumer_offsets-28 -> List(0), __consumer_offsets-31 -> List(0), __consumer_offsets-36 -> List(0), __consumer_offsets-42 -> List(0), __consumer_offsets-3 -> List(0), test-topic-3 -> List(0), __consumer_offsets-18 -> List(0), __consumer_offsets-15 -> List(0), __consumer_offsets-24 -> List(0), test-topic-1 -> List(0), __consumer_offsets-38 -> List(0), __consumer_offsets-17 -> List(0), __consumer_offsets-48 -> List(0), __consumer_offsets-19 -> List(0), __consumer_offsets-11 -> List(0), __consumer_offsets-2 -> List(0), __consumer_offsets-43 -> List(0), __consumer_offsets-6 -> List(0), __consumer_offsets-14 -> List(0), __consumer_offsets-20 -> List(0), __consumer_offsets-0 -> List(0), __consumer_offsets-44 -> List(0), __consumer_offsets-39 -> List(0), __consumer_offsets-12 -> List(0), __consumer_offsets-45 -> List(0), __consumer_offsets-1 -> List(0), __consumer_offsets-5 -> List(0), __consumer_offsets-26 -> List(0), __consumer_offsets-29 -> List(0), __consumer_offsets-34 -> List(0), __consumer_offsets-10 -> List(0), __consumer_offsets-32 -> List(0), __consumer_offsets-40 -> List(0)) (kafka.controller.KafkaController)
[2022-08-10 16:09:18,194] TRACE [Controller id=1] Leader imbalance ratio for broker 0 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 16:09:18,195] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:09:18,195] DEBUG [Controller id=1] Topics not in preferred replica for broker 1 HashMap(library-events-2 -> List(1, 2, 0)) (kafka.controller.KafkaController)
[2022-08-10 16:09:18,195] TRACE [Controller id=1] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 16:09:18,195] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:09:18,195] DEBUG [Controller id=1] Topics not in preferred replica for broker 2 HashMap(library-events-1 -> List(2, 0, 1)) (kafka.controller.KafkaController)
[2022-08-10 16:09:18,195] TRACE [Controller id=1] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2022-08-10 16:09:18,196] INFO [Controller id=1] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2022-08-10 16:12:29,171] INFO [Controller id=1] Shutting down broker 1 (kafka.controller.KafkaController)
[2022-08-10 16:12:29,171] DEBUG [Controller id=1] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2022-08-10 16:12:29,171] DEBUG [Controller id=1] Live brokers:  (kafka.controller.KafkaController)
[2022-08-10 16:12:29,184] INFO [RequestSendThread controllerId=1] Controller 1 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 16:12:29,192] TRACE [Controller id=1] All leaders = __consumer_offsets-13 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-46 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-9 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-42 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-SSL-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:30),library-events-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:45,ZkVersion:61,ControllerEpoch:30),__consumer_offsets-21 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-17 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-2 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-30 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-26 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-5 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-38 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-1 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-34 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-16 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-45 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-12 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-41 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),library-events-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:46,ZkVersion:62,ControllerEpoch:30),__consumer_offsets-24 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-20 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-49 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-SSL-1 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:30),__consumer_offsets-0 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-29 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-1 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-25 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-8 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-37 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-4 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-33 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-15 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-48 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-11 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-44 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-23 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-19 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-SSL-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:30),library-events-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:38,ZkVersion:54,ControllerEpoch:30),__consumer_offsets-32 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-0 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-28 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-7 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-40 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-3 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-36 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-47 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-14 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-43 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-10 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-22 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-18 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-31 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),test-topic-3 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-27 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-39 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-6 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-35 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30),__consumer_offsets-2 -> (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) (kafka.controller.KafkaController)
[2022-08-10 16:12:29,217] WARN [RequestSendThread controllerId=1] Controller 1 epoch 30 fails to send request (type: UpdateMetadataRequest=, controllerId=1, controllerEpoch=30, brokerEpoch=2404, partitionStates=[UpdateMetadataPartitionState(topicName='library-events', partitionIndex=2, controllerEpoch=30, leader=-1, leaderEpoch=45, isr=[2], zkVersion=61, replicas=[1, 2, 0], offlineReplicas=[1, 2, 0]), UpdateMetadataPartitionState(topicName='library-events', partitionIndex=1, controllerEpoch=30, leader=-1, leaderEpoch=46, isr=[2], zkVersion=62, replicas=[2, 0, 1], offlineReplicas=[2, 0, 1]), UpdateMetadataPartitionState(topicName='library-events', partitionIndex=0, controllerEpoch=30, leader=-1, leaderEpoch=38, isr=[2], zkVersion=54, replicas=[0, 1, 2], offlineReplicas=[0, 1, 2])], liveBrokers=UpdateMetadataBroker(id=1, v0Host='', v0Port=0, endpoints=[UpdateMetadataEndpoint(port=9093, host='localhost', listener='PLAINTEXT', securityProtocol=0), UpdateMetadataEndpoint(port=9096, host='localhost', listener='SSL', securityProtocol=1)], rack=null)) to broker localhost:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 16:12:29,314] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:12:29,315] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:12:29,315] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:12:29,316] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2022-08-10 16:12:29,316] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set(1) (kafka.controller.KafkaController)
[2022-08-10 16:12:29,317] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:12:29,319] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:12:29,319] INFO [RequestSendThread controllerId=1] Shutting down (kafka.controller.RequestSendThread)
[2022-08-10 16:12:29,320] ERROR [RequestSendThread controllerId=1] Controller 1 fails to send a request to broker localhost:9093 (id: 1 rack: null) (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 16:12:29,320] INFO [RequestSendThread controllerId=1] Stopped (kafka.controller.RequestSendThread)
[2022-08-10 16:12:29,321] INFO [RequestSendThread controllerId=1] Shutdown completed (kafka.controller.RequestSendThread)
[2022-08-10 16:12:29,322] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2022-08-10 16:13:43,354] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:13:43,394] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2022-08-10 16:13:43,402] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(Enabled,Features{}) (kafka.controller.KafkaController)
[2022-08-10 16:13:43,461] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2022-08-10 16:13:43,468] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2022-08-10 16:13:43,476] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2022-08-10 16:13:43,480] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2022-08-10 16:13:43,510] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2022-08-10 16:13:43,519] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-08-10 16:13:43,532] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2022-08-10 16:13:43,546] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2022-08-10 16:13:43,547] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 16:13:43,547] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2022-08-10 16:13:43,548] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2022-08-10 16:13:43,552] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 16:13:43,553] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2022-08-10 16:13:43,554] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2022-08-10 16:13:43,554] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2022-08-10 16:13:43,555] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2022-08-10 16:13:43,556] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2022-08-10 16:13:43,578] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:13:43,579] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:13:43,592] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:13:43,593] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:13:43,594] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:13:43,601] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:13:43,604] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 16:13:43,609] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:13:43,610] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2022-08-10 16:13:43,624] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 16:13:43,630] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2022-08-10 16:13:43,630] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2022-08-10 16:13:43,644] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2022-08-10 16:13:43,650] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2022-08-10 16:13:43,677] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2022-08-10 16:13:48,690] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2022-08-10 16:13:48,691] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2022-08-10 16:14:00,106] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2022-08-10 16:14:00,107] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2022-08-10 16:14:00,115] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2022-08-10 16:14:00,123] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2022-08-10 16:14:00,126] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2022-08-10 16:14:00,127] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 16:14:00,130] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 16:14:00,197] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:14:00,222] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-08-10 16:15:12,562] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2022-08-10 16:15:12,562] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2022-08-10 16:15:12,572] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2022-08-10 16:15:12,575] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2022-08-10 16:15:12,577] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45, 2 -> 61) (kafka.controller.KafkaController)
[2022-08-10 16:15:12,583] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2022-08-10 16:15:12,596] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2022-08-10 16:15:12,750] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:15:12,881] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2022-08-10 16:16:50,487] INFO [Controller id=0] New topics: [Set(test-topic)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(test-topic,Some(Yn4GSVlbSxWG5OshDK7dLQ),Map(test-topic-0 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), test-topic-1 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), test-topic-2 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2022-08-10 16:16:50,488] INFO [Controller id=0] New partition creation callback for test-topic-0,test-topic-1,test-topic-2 (kafka.controller.KafkaController)
[2022-08-10 16:17:18,807] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2022-08-10 16:17:18,808] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2022-08-10 16:17:18,808] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2022-08-10 16:17:18,812] TRACE [Controller id=0] All leaders = test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),test-topic-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),test-topic-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2022-08-10 16:17:18,956] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:18,958] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:18,958] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:18,959] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2022-08-10 16:17:18,960] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-08-10 16:17:18,961] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:17:18,962] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:17:18,963] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2022-08-10 16:17:18,979] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2022-08-10 16:17:18,980] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-08-10 16:17:18,981] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-08-10 16:17:18,981] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-08-10 16:17:18,990] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2022-08-10 16:17:18,991] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-08-10 16:17:19,044] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2022-08-10 16:17:19,046] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25, 1 -> 45) (kafka.controller.KafkaController)
[2022-08-10 16:17:24,747] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2022-08-10 16:17:24,748] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2022-08-10 16:17:24,748] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2022-08-10 16:17:24,748] TRACE [Controller id=0] All leaders = test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),test-topic-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),test-topic-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1) (kafka.controller.KafkaController)
[2022-08-10 16:17:24,886] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:24,888] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:24,888] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:24,889] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2022-08-10 16:17:24,890] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2022-08-10 16:17:24,892] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:17:24,893] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:17:24,894] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2022-08-10 16:17:24,912] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2022-08-10 16:17:24,912] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-08-10 16:17:24,913] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-08-10 16:17:24,913] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-08-10 16:17:24,917] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2022-08-10 16:17:24,917] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2022-08-10 16:17:24,928] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2022-08-10 16:17:24,928] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2022-08-10 16:17:30,377] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2022-08-10 16:17:30,377] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2022-08-10 16:17:30,377] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2022-08-10 16:17:30,378] TRACE [Controller id=0] All leaders = test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),test-topic-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1),test-topic-1 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) (kafka.controller.KafkaController)
[2022-08-10 16:17:30,516] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:30,517] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:30,517] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2022-08-10 16:17:30,518] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2022-08-10 16:17:30,518] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2022-08-10 16:17:30,519] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2022-08-10 16:17:30,521] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2022-08-10 16:17:30,522] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2022-08-10 16:17:30,522] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2022-08-10 16:17:30,522] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2022-08-10 16:17:30,524] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
[2024-01-21 22:47:19,195] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 22:47:19,247] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 2 and epoch zk version is now 2 (kafka.controller.KafkaController)
[2024-01-21 22:47:19,251] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2024-01-21 22:47:19,258] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2024-01-21 22:47:19,263] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2024-01-21 22:47:19,269] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2024-01-21 22:47:19,297] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 92) (kafka.controller.KafkaController)
[2024-01-21 22:47:19,331] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2024-01-21 22:47:19,359] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2024-01-21 22:47:19,392] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2024-01-21 22:47:19,394] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2024-01-21 22:47:19,395] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2024-01-21 22:47:19,395] INFO [Controller id=0] Current list of topics in the cluster: HashSet(test-topic) (kafka.controller.KafkaController)
[2024-01-21 22:47:19,395] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2024-01-21 22:47:19,402] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2024-01-21 22:47:19,403] INFO [Controller id=0] List of topics ineligible for deletion: test-topic (kafka.controller.KafkaController)
[2024-01-21 22:47:19,403] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2024-01-21 22:47:19,405] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet(test-topic) (kafka.controller.TopicDeletionManager)
[2024-01-21 22:47:19,418] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2024-01-21 22:47:19,445] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 22:47:19,455] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-01-21 22:47:19,456] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 22:47:19,491] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 22:47:19,550] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap([Topic=test-topic,Partition=2,Replica=0] -> OnlineReplica, [Topic=test-topic,Partition=1,Replica=1] -> OfflineReplica, [Topic=test-topic,Partition=0,Replica=2] -> OfflineReplica) (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 22:47:19,554] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2024-01-21 22:47:19,562] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2024-01-21 22:47:19,629] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap(test-topic-2 -> OnlinePartition, test-topic-0 -> OfflinePartition, test-topic-1 -> OfflinePartition) (kafka.controller.ZkPartitionStateMachine)
[2024-01-21 22:47:19,630] INFO [Controller id=0] Ready to serve as the new controller with epoch 2 (kafka.controller.KafkaController)
[2024-01-21 22:47:19,637] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2024-01-21 22:47:19,638] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2024-01-21 22:47:19,638] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2024-01-21 22:47:19,638] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2024-01-21 22:47:19,642] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2024-01-21 22:47:19,664] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2024-01-21 22:47:24,677] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 22:47:24,677] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 22:47:24,679] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2024-01-21 22:47:24,681] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 22:47:24,681] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map(test-topic-1 -> List(1)) (kafka.controller.KafkaController)
[2024-01-21 22:47:24,681] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2024-01-21 22:47:24,683] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2024-01-21 22:47:24,683] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(test-topic-0 -> List(2)) (kafka.controller.KafkaController)
[2024-01-21 22:47:24,683] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2024-01-21 22:47:24,683] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2024-01-21 22:52:24,688] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 22:52:24,688] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 Map() (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 Map(test-topic-1 -> List(1)) (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 Map(test-topic-0 -> List(2)) (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 1.0 (kafka.controller.KafkaController)
[2024-01-21 22:52:24,689] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by AutoTriggered (kafka.controller.KafkaController)
[2024-01-21 22:54:17,146] INFO [Controller id=0] Newly added brokers: 1, deleted brokers: , bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2024-01-21 22:54:17,147] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 1 (kafka.controller.ControllerChannelManager)
[2024-01-21 22:54:17,157] INFO [Controller id=0] New broker startup callback for 1 (kafka.controller.KafkaController)
[2024-01-21 22:54:17,192] DEBUG [Controller id=0] Register BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2024-01-21 22:54:17,197] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 92, 1 -> 112) (kafka.controller.KafkaController)
[2024-01-21 22:54:17,199] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2024-01-21 22:54:17,201] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-01-21 22:54:17,291] INFO [ControllerEventThread controllerId=1] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 22:54:17,325] DEBUG [Controller id=1] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2024-01-21 22:54:45,624] INFO [Controller id=0] Newly added brokers: 2, deleted brokers: , bounced brokers: , all live brokers: 0,1,2 (kafka.controller.KafkaController)
[2024-01-21 22:54:45,624] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 2 (kafka.controller.ControllerChannelManager)
[2024-01-21 22:54:45,629] INFO [Controller id=0] New broker startup callback for 2 (kafka.controller.KafkaController)
[2024-01-21 22:54:45,646] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2024-01-21 22:54:45,649] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-01-21 22:54:45,650] DEBUG [Controller id=0] Register BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2024-01-21 22:54:45,655] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 92, 1 -> 112, 2 -> 129) (kafka.controller.KafkaController)
[2024-01-21 22:54:45,742] INFO [ControllerEventThread controllerId=2] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 22:54:45,779] DEBUG [Controller id=2] Broker 0 has been elected as the controller, so stopping the election process. (kafka.controller.KafkaController)
[2024-01-21 22:55:13,681] INFO [Controller id=0] New topics: [Set(library-events)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(library-events,Some(ZjEX9glPQiiI-OItiEmH-g),Map(library-events-0 -> ReplicaAssignment(replicas=2,1,0, addingReplicas=, removingReplicas=), library-events-1 -> ReplicaAssignment(replicas=1,0,2, addingReplicas=, removingReplicas=), library-events-2 -> ReplicaAssignment(replicas=0,2,1, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2024-01-21 22:55:13,682] INFO [Controller id=0] New partition creation callback for library-events-0,library-events-1,library-events-2 (kafka.controller.KafkaController)
[2024-01-21 22:57:24,700] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 22:57:24,700] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 22:57:24,701] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 22:57:24,701] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 22:57:24,701] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 22:57:24,701] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 22:57:24,701] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 22:57:24,701] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 22:59:06,318] INFO [Controller id=0] New topics: [Set(__consumer_offsets)], deleted topics: [HashSet()], new partition replica assignment [Set(TopicIdReplicaAssignment(__consumer_offsets,Some(pufcHmYGSOCnT4Xgvpe_5w),HashMap(__consumer_offsets-22 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-30 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-25 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-35 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-37 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-38 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-13 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-8 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-21 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-4 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-27 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-7 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-9 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-46 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-41 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-33 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-23 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-49 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-47 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-16 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-28 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-31 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-36 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-42 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-3 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-18 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-15 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-24 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-17 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-48 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-19 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-11 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-2 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-43 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-6 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-14 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-20 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-0 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-44 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-39 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-12 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-45 -> ReplicaAssignment(replicas=1, addingReplicas=, removingReplicas=), __consumer_offsets-1 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-5 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-26 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-29 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-34 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-10 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=), __consumer_offsets-32 -> ReplicaAssignment(replicas=2, addingReplicas=, removingReplicas=), __consumer_offsets-40 -> ReplicaAssignment(replicas=0, addingReplicas=, removingReplicas=))))] (kafka.controller.KafkaController)
[2024-01-21 22:59:06,319] INFO [Controller id=0] New partition creation callback for __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-25,__consumer_offsets-35,__consumer_offsets-37,__consumer_offsets-38,__consumer_offsets-13,__consumer_offsets-8,__consumer_offsets-21,__consumer_offsets-4,__consumer_offsets-27,__consumer_offsets-7,__consumer_offsets-9,__consumer_offsets-46,__consumer_offsets-41,__consumer_offsets-33,__consumer_offsets-23,__consumer_offsets-49,__consumer_offsets-47,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-31,__consumer_offsets-36,__consumer_offsets-42,__consumer_offsets-3,__consumer_offsets-18,__consumer_offsets-15,__consumer_offsets-24,__consumer_offsets-17,__consumer_offsets-48,__consumer_offsets-19,__consumer_offsets-11,__consumer_offsets-2,__consumer_offsets-43,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-39,__consumer_offsets-12,__consumer_offsets-45,__consumer_offsets-1,__consumer_offsets-5,__consumer_offsets-26,__consumer_offsets-29,__consumer_offsets-34,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 (kafka.controller.KafkaController)
[2024-01-21 23:02:24,710] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:02:24,714] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:02:24,715] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:02:24,715] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:02:24,715] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:02:24,715] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:02:24,715] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:02:24,715] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:07:24,726] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:07:24,726] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:07:24,728] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:07:24,728] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:07:24,728] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:07:24,728] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:07:24,728] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:07:24,728] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:12:24,738] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:12:24,738] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:12:24,739] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:12:24,739] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:12:24,739] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:12:24,739] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:12:24,739] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:12:24,739] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:17:24,748] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:17:24,748] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:17:24,750] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:17:24,750] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:17:24,750] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:17:24,750] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:17:24,750] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:17:24,750] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:22:24,761] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:22:24,761] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:22:24,762] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:22:24,762] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:22:24,762] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:22:24,762] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:22:24,762] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:22:24,762] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:27:24,769] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:27:24,770] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:27:24,771] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:27:24,771] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:27:24,771] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:27:24,771] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:27:24,771] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:27:24,771] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:32:24,784] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:32:24,784] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:32:24,785] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:32:24,785] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:32:24,785] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:32:24,785] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:32:24,785] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:32:24,785] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:32:44,604] DEBUG [Controller id=0] There is no producerId block yet (Zk path version 0), creating the first block (kafka.controller.KafkaController)
[2024-01-21 23:32:44,622] INFO [Controller id=0] Acquired new producerId block ProducerIdsBlock(assignedBrokerId=1, firstProducerId=0, size=1000) by writing to Zk with path version 1 (kafka.controller.KafkaController)
[2024-01-21 23:37:24,794] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:37:24,794] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:37:24,795] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:37:24,795] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:37:24,795] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:37:24,795] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:37:24,795] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:37:24,795] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:42:24,807] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-01-21 23:42:24,807] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-01-21 23:42:24,808] DEBUG [Controller id=0] Topics not in preferred replica for broker 0 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:42:24,808] TRACE [Controller id=0] Leader imbalance ratio for broker 0 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:42:24,808] DEBUG [Controller id=0] Topics not in preferred replica for broker 1 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:42:24,808] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:42:24,808] DEBUG [Controller id=0] Topics not in preferred replica for broker 2 HashMap() (kafka.controller.KafkaController)
[2024-01-21 23:42:24,808] TRACE [Controller id=0] Leader imbalance ratio for broker 2 is 0.0 (kafka.controller.KafkaController)
[2024-01-21 23:43:00,433] INFO [Controller id=0] Shutting down broker 2 (kafka.controller.KafkaController)
[2024-01-21 23:43:00,433] DEBUG [Controller id=0] All shutting down brokers: 2 (kafka.controller.KafkaController)
[2024-01-21 23:43:00,433] DEBUG [Controller id=0] Live brokers: 0,1 (kafka.controller.KafkaController)
[2024-01-21 23:43:00,476] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,477] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9093 (id: 1 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,479] INFO [RequestSendThread controllerId=0] Controller 0 connected to localhost:9094 (id: 2 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,491] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-2 -> (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-1 -> (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),test-topic-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-0 -> (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),test-topic-0 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2) (kafka.controller.KafkaController)
[2024-01-21 23:43:00,533] WARN [RequestSendThread controllerId=0] Controller 0 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=2, brokerEpoch=129, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='library-events', partitionStates=[StopReplicaPartitionState(partitionIndex=1, leaderEpoch=0, deletePartition=false), StopReplicaPartitionState(partitionIndex=2, leaderEpoch=0, deletePartition=false)])) to broker localhost:9094 (id: 2 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 2 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,653] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,759] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker localhost:9094 (id: 2 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9094 (id: 2 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,789] INFO [ControllerEventThread controllerId=2] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:00,791] INFO [ControllerEventThread controllerId=2] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:00,791] INFO [ControllerEventThread controllerId=2] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:00,795] DEBUG [Controller id=2] Resigning (kafka.controller.KafkaController)
[2024-01-21 23:43:00,796] DEBUG [Controller id=2] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2024-01-21 23:43:00,797] INFO [PartitionStateMachine controllerId=2] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2024-01-21 23:43:00,798] INFO [ReplicaStateMachine controllerId=2] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 23:43:00,800] INFO [Controller id=2] Resigned (kafka.controller.KafkaController)
[2024-01-21 23:43:00,833] INFO [Controller id=0] Newly added brokers: , deleted brokers: 2, bounced brokers: , all live brokers: 0,1 (kafka.controller.KafkaController)
[2024-01-21 23:43:00,834] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,834] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,834] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,834] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2024-01-21 23:43:00,837] INFO [Controller id=0] Broker failure callback for 2 (kafka.controller.KafkaController)
[2024-01-21 23:43:00,837] INFO [Controller id=0] Removed 2 from list of shutting down brokers. (kafka.controller.KafkaController)
[2024-01-21 23:43:00,888] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(2) (kafka.controller.KafkaController)
[2024-01-21 23:43:00,894] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 92, 1 -> 112) (kafka.controller.KafkaController)
[2024-01-21 23:43:10,855] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2024-01-21 23:43:10,855] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2024-01-21 23:43:10,855] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:10,880] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-1 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2024-01-21 23:43:10,912] WARN [RequestSendThread controllerId=0] Controller 0 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=2, brokerEpoch=112, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='library-events', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=1, deletePartition=false)])) to broker localhost:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.io.IOException: Connection to 1 was disconnected before the response was read
	at org.apache.kafka.clients.NetworkClientUtils.sendAndReceive(NetworkClientUtils.java:99)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:252)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,017] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker localhost:9093 (id: 1 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to localhost:9093 (id: 1 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:70)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:291)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:245)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,087] INFO [ControllerEventThread controllerId=1] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:11,090] INFO [ControllerEventThread controllerId=1] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:11,090] INFO [ControllerEventThread controllerId=1] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:11,092] DEBUG [Controller id=1] Resigning (kafka.controller.KafkaController)
[2024-01-21 23:43:11,092] DEBUG [Controller id=1] Unregister BrokerModifications handler for Set() (kafka.controller.KafkaController)
[2024-01-21 23:43:11,094] INFO [PartitionStateMachine controllerId=1] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2024-01-21 23:43:11,096] INFO [ReplicaStateMachine controllerId=1] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 23:43:11,097] INFO [Controller id=1] Resigned (kafka.controller.KafkaController)
[2024-01-21 23:43:11,111] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, bounced brokers: , all live brokers: 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:11,111] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2024-01-21 23:43:11,112] WARN [RequestSendThread controllerId=0] Controller 0 epoch 2 fails to send request (type=StopReplicaRequest, controllerId=0, controllerEpoch=2, brokerEpoch=112, deletePartitions=false, topicStates=StopReplicaTopicState(topicName='library-events', partitionStates=[StopReplicaPartitionState(partitionIndex=2, leaderEpoch=1, deletePartition=false)])) to broker localhost:9093 (id: 1 rack: null). Reconnecting to broker. (kafka.controller.RequestSendThread)
java.lang.InterruptedException
	at java.base/java.util.concurrent.locks.AbstractQueuedSynchronizer.tryAcquireSharedNanos(AbstractQueuedSynchronizer.java:1081)
	at java.base/java.util.concurrent.CountDownLatch.await(CountDownLatch.java:276)
	at kafka.utils.ShutdownableThread.pause(ShutdownableThread.scala:82)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:233)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,114] TRACE [RequestSendThread controllerId=0] shutdownInitiated latch count reached zero. Shutdown called. (kafka.controller.RequestSendThread)
[2024-01-21 23:43:11,114] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2024-01-21 23:43:11,114] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2024-01-21 23:43:11,116] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2024-01-21 23:43:11,116] INFO [Controller id=0] Removed 1 from list of shutting down brokers. (kafka.controller.KafkaController)
[2024-01-21 23:43:11,161] DEBUG [Controller id=0] Unregister BrokerModifications handler for List(1) (kafka.controller.KafkaController)
[2024-01-21 23:43:11,161] INFO [Controller id=0] Updated broker epochs cache: HashMap(0 -> 92) (kafka.controller.KafkaController)
[2024-01-21 23:43:20,828] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:20,828] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:20,828] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2024-01-21 23:43:20,831] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-1 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2024-01-21 23:43:25,844] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:25,844] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:25,844] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2024-01-21 23:43:25,846] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-1 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2024-01-21 23:43:31,227] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:31,227] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2024-01-21 23:43:31,227] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2024-01-21 23:43:31,230] TRACE [Controller id=0] All leaders = __consumer_offsets-13 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-46 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-9 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-42 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-21 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-17 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-2 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:1),__consumer_offsets-30 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-26 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-5 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-38 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-34 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-16 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-45 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-12 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-41 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),library-events-1 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-24 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-20 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-49 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-0 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-29 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-1 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-25 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-8 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-37 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-4 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-33 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-15 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-48 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-11 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-44 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-23 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-19 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),library-events-0 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2),__consumer_offsets-32 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),test-topic-0 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2),__consumer_offsets-28 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-7 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-40 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-3 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-36 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-47 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-14 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-43 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-10 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-22 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-18 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-31 -> (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:0,ControllerEpoch:2),__consumer_offsets-27 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-39 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-6 -> (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-35 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2),__consumer_offsets-2 -> (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2024-01-21 23:43:31,421] INFO [ControllerEventThread controllerId=0] Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:31,421] INFO [ControllerEventThread controllerId=0] Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:31,421] INFO [ControllerEventThread controllerId=0] Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-01-21 23:43:31,424] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2024-01-21 23:43:31,424] DEBUG [Controller id=0] Unregister BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2024-01-21 23:43:31,425] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.ZkPartitionStateMachine)
[2024-01-21 23:43:31,425] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ZkReplicaStateMachine)
[2024-01-21 23:43:31,426] INFO [RequestSendThread controllerId=0] Shutting down (kafka.controller.RequestSendThread)
[2024-01-21 23:43:31,426] INFO [RequestSendThread controllerId=0] Stopped (kafka.controller.RequestSendThread)
[2024-01-21 23:43:31,426] INFO [RequestSendThread controllerId=0] Shutdown completed (kafka.controller.RequestSendThread)
[2024-01-21 23:43:31,427] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
