[2022-08-10 15:22:53,252] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 15:22:53,342] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 60 become-follower partitions (state.change.logger)
[2022-08-10 15:22:53,359] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 60 partitions (state.change.logger)
[2022-08-10 15:22:53,406] INFO [Controller id=0 epoch=26] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:33,ZkVersion:49,ControllerEpoch:26) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,407] INFO [Controller id=0 epoch=26] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:26) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,407] INFO [Controller id=0 epoch=26] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:40,ZkVersion:56,ControllerEpoch:26) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,407] INFO [Controller id=0 epoch=26] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:41,ZkVersion:57,ControllerEpoch:26) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,408] INFO [Controller id=0 epoch=26] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:26) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,408] INFO [Controller id=0 epoch=26] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:26) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,443] INFO [Controller id=0 epoch=26] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:34,ZkVersion:50,ControllerEpoch:26) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,444] INFO [Controller id=0 epoch=26] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:26) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,444] INFO [Controller id=0 epoch=26] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:41,ZkVersion:57,ControllerEpoch:26) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,444] INFO [Controller id=0 epoch=26] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:42,ZkVersion:58,ControllerEpoch:26) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,455] INFO [Controller id=0 epoch=26] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:26) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,455] INFO [Controller id=0 epoch=26] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:26) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:22:53,455] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-08-10 15:22:53,455] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
[2022-08-10 15:22:53,514] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 60 partitions (state.change.logger)
[2022-08-10 15:22:53,680] ERROR [Controller id=0 epoch=26] Controller 0 epoch 26 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:22:53,683] ERROR [Controller id=0 epoch=26] Controller 0 epoch 26 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:22:53,684] ERROR [Controller id=0 epoch=26] Controller 0 epoch 26 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,686] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,687] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=19, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=19) (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-10 15:22:53,688] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 54 partitions (state.change.logger)
[2022-08-10 15:22:53,694] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-3 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,708] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-18 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,711] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-41 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,716] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-SSL-2 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,717] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-10 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,718] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-33 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,719] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-48 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,720] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-19 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,721] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-34 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,722] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-4 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,722] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-11 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,723] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-26 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,731] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-49 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,732] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-SSL-1 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,736] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-39 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,737] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-9 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,737] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-24 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,740] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-3 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,741] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-31 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,745] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-46 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,745] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-1 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,746] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-16 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-2 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,747] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-25 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,748] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-40 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,749] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-47 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,750] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-17 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,751] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-32 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,752] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-37 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,752] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-7 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,753] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-22 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,754] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-1 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,758] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-29 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,761] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-44 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,762] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-14 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,762] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition library-events-2 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,763] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-23 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,764] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-2 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,764] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-38 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,765] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-8 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,767] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-45 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,768] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-15 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,769] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-30 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,769] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-0 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,770] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-35 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,774] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-5 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,778] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-20 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,778] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-27 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,778] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-42 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,779] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition library-events-0 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,779] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-12 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,780] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-SSL-0 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,780] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-21 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,781] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition test-topic-0 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,782] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-36 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,783] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-6 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,784] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-43 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,784] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition library-events-1 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,785] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-13 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,788] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 26 for partition __consumer_offsets-28 (last update controller epoch 25) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,794] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 26 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-10 15:22:53,810] INFO [Broker id=0] Finished LeaderAndIsr request in 301ms correlationId 1 from controller 0 for 60 partitions (state.change.logger)
[2022-08-10 15:22:53,830] INFO [Broker id=0] Add 57 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 2 (state.change.logger)
[2022-08-10 15:22:53,838] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:22:53,838] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 26 for partition library-events-1 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,839] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 26 for partition library-events-0 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,839] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 26 for partition library-events-2 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:22:53,839] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 26 with correlation id 3 for 0 partitions (state.change.logger)
[2022-08-10 15:22:53,840] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:22:53,842] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 4 (state.change.logger)
[2022-08-10 15:22:53,845] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 54 partitions (state.change.logger)
[2022-08-10 15:22:53,851] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 26 as part of the become-leader transition for 54 partitions (state.change.logger)
[2022-08-10 15:22:53,856] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,861] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,862] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,864] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,867] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,870] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,871] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,873] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,874] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,876] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,878] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,879] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,881] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,884] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,885] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,887] INFO [Broker id=0] Leader test-topic-3 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,888] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,890] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,892] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,893] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,895] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,896] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,898] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,900] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,901] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,902] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,904] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,905] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,907] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,909] INFO [Broker id=0] Leader test-topic-1 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,911] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,913] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,914] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,916] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,917] INFO [Broker id=0] Leader test-topic-2 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,918] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,920] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,921] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,922] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,924] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,925] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,926] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,928] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,929] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,932] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,933] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,935] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,936] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,938] INFO [Broker id=0] Leader test-topic-0 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,939] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,941] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,942] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,943] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:53,945] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:22:54,140] INFO [Broker id=0] Finished LeaderAndIsr request in 295ms correlationId 5 from controller 0 for 54 partitions (state.change.logger)
[2022-08-10 15:22:54,143] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 6 (state.change.logger)
[2022-08-10 15:24:18,476] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:24:18,478] INFO [Controller id=0 epoch=26] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-08-10 15:24:18,481] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:24:18,486] INFO [Controller id=0 epoch=26] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:42,ZkVersion:58,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:24:18,486] INFO [Controller id=0 epoch=26] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:41,ZkVersion:57,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:24:18,486] INFO [Controller id=0 epoch=26] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:34,ZkVersion:50,ControllerEpoch:26) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:24:18,487] INFO [Controller id=0 epoch=26] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
[2022-08-10 15:24:18,488] INFO [Controller id=0 epoch=26] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-08-10 15:24:18,503] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 26 with correlation id 8 (state.change.logger)
[2022-08-10 15:24:18,505] INFO [Broker id=0] Handling StopReplica request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:32:10,901] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 15:32:10,978] INFO [Controller id=0 epoch=27] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 6 become-follower partitions (state.change.logger)
[2022-08-10 15:32:10,983] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(0) for 60 partitions (state.change.logger)
[2022-08-10 15:32:11,013] INFO [Controller id=0 epoch=27] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:34,ZkVersion:50,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,015] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,015] INFO [Controller id=0 epoch=27] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:41,ZkVersion:57,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,016] INFO [Controller id=0 epoch=27] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:42,ZkVersion:58,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,016] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,016] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,053] INFO [Controller id=0 epoch=27] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:35,ZkVersion:51,ControllerEpoch:27) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,054] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,054] INFO [Controller id=0 epoch=27] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:42,ZkVersion:58,ControllerEpoch:27) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,054] INFO [Controller id=0 epoch=27] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:43,ZkVersion:59,ControllerEpoch:27) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,055] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,055] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:11,055] INFO [Controller id=0 epoch=27] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-08-10 15:32:11,055] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
[2022-08-10 15:32:11,116] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 60 partitions (state.change.logger)
[2022-08-10 15:32:11,139] ERROR [Controller id=0 epoch=27] Controller 0 epoch 27 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:32:11,144] ERROR [Controller id=0 epoch=27] Controller 0 epoch 27 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:32:11,144] ERROR [Controller id=0 epoch=27] Controller 0 epoch 27 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:32:11,147] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:11,225] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 27 as part of the become-leader transition for 54 partitions (state.change.logger)
[2022-08-10 15:32:11,244] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,251] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,257] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,261] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,264] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,270] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,276] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,279] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,282] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,287] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,294] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,297] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,302] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,307] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,310] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,313] INFO [Broker id=0] Leader test-topic-3 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,319] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,325] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,328] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,332] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,337] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,343] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,349] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,352] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,358] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,361] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,365] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,370] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,374] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,377] INFO [Broker id=0] Leader test-topic-1 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,382] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,387] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,391] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,396] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,399] INFO [Broker id=0] Leader test-topic-2 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,404] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,408] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,413] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,417] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,420] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,425] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,433] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,435] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,438] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,445] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,448] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,452] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,454] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,460] INFO [Broker id=0] Leader test-topic-0 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,465] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,468] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,470] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,473] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,477] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:32:11,484] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 27 for partition library-events-1 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,485] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 27 for partition test-topic-SSL-2 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,485] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 27 for partition library-events-0 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,486] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 27 for partition test-topic-SSL-0 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,487] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 27 for partition library-events-2 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,487] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 27 for partition test-topic-SSL-1 (last update controller epoch 26) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,489] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 27 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-10 15:32:11,735] INFO [Broker id=0] Finished LeaderAndIsr request in 622ms correlationId 1 from controller 0 for 60 partitions (state.change.logger)
[2022-08-10 15:32:11,753] INFO [Broker id=0] Add 57 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 2 (state.change.logger)
[2022-08-10 15:32:11,761] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:32:11,762] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 27 for partition library-events-1 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,763] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 27 for partition library-events-0 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,763] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 27 for partition library-events-2 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:32:11,763] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 27 with correlation id 3 for 0 partitions (state.change.logger)
[2022-08-10 15:32:11,763] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:32:11,766] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 4 (state.change.logger)
[2022-08-10 15:32:55,375] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,379] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(1) for 57 partitions (state.change.logger)
[2022-08-10 15:32:55,384] INFO [Controller id=0 epoch=27] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-08-10 15:32:55,385] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(0, 1) for 6 partitions (state.change.logger)
[2022-08-10 15:32:55,395] ERROR [Controller id=0 epoch=27] Controller 0 epoch 27 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:32:55,395] ERROR [Controller id=0 epoch=27] Controller 0 epoch 27 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:32:55,396] ERROR [Controller id=0 epoch=27] Controller 0 epoch 27 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:32:55,396] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,398] INFO [Broker id=0] Add 3 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 6 (state.change.logger)
[2022-08-10 15:32:55,403] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,404] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,405] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet(0, 1) for 3 partitions (state.change.logger)
[2022-08-10 15:32:55,406] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 7 (state.change.logger)
[2022-08-10 15:32:55,411] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,415] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:55,415] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:55,415] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:55,419] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:55,419] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:55,419] INFO [Controller id=0 epoch=27] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:27) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:32:55,419] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,420] INFO [Controller id=0 epoch=27] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-08-10 15:32:55,421] INFO [Controller id=0 epoch=27] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 15:32:55,423] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,423] INFO [Controller id=0 epoch=27] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-08-10 15:32:55,424] INFO [Controller id=0 epoch=27] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 15:32:55,424] INFO [Broker id=0] Handling StopReplica request correlationId 8 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:32:55,435] INFO [Broker id=0] Handling StopReplica request correlationId 9 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:32:55,469] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 9 epoch 27 for partition test-topic-SSL-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2022-08-10 15:32:55,469] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 9 epoch 27 for partition test-topic-SSL-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2022-08-10 15:32:55,469] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 9 epoch 27 for partition test-topic-SSL-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2022-08-10 15:32:55,474] INFO [Controller id=0 epoch=27] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:32:55,800] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 27 with correlation id 0 (state.change.logger)
[2022-08-10 15:33:15,754] INFO [Controller id=1 epoch=28] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2022-08-10 15:33:15,787] INFO [Controller id=1 epoch=28] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-08-10 15:33:15,789] INFO [Controller id=1 epoch=28] Sending UpdateMetadata request to brokers HashSet(1) for 6 partitions (state.change.logger)
[2022-08-10 15:33:15,796] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 6 partitions (state.change.logger)
[2022-08-10 15:33:15,851] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 28 for partition library-events-1 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,859] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 28 for partition test-topic-SSL-2 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,867] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 28 for partition library-events-0 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,871] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 28 for partition test-topic-SSL-0 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,873] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 28 for partition library-events-2 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,877] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 28 for partition test-topic-SSL-1 (last update controller epoch 27) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,904] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 28 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-10 15:33:15,939] INFO [Broker id=1] Finished LeaderAndIsr request in 145ms correlationId 1 from controller 1 for 6 partitions (state.change.logger)
[2022-08-10 15:33:15,946] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,947] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,947] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,949] INFO [Controller id=1 epoch=28] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,949] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,950] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,950] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,950] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,951] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,951] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,951] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,952] INFO [Controller id=1 epoch=28] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:35,ZkVersion:51,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,952] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,952] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,953] INFO [Controller id=1 epoch=28] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,953] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,954] INFO [Broker id=1] Add 3 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 28 with correlation id 2 (state.change.logger)
[2022-08-10 15:33:15,954] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,955] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,955] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,956] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,956] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,956] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,956] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,957] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,957] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,957] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,957] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,957] INFO [Controller id=1 epoch=28] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,958] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,958] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,958] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,960] INFO [Controller id=1 epoch=28] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,961] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,962] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,962] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,962] INFO [Controller id=1 epoch=28] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:42,ZkVersion:58,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,963] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,964] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,964] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,964] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,965] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,965] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,966] INFO [Controller id=1 epoch=28] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,966] INFO [Controller id=1 epoch=28] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:43,ZkVersion:59,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,967] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,967] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,968] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,968] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,968] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,968] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,968] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,969] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,969] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,969] INFO [Controller id=1 epoch=28] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,969] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,969] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,969] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,970] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,970] INFO [Controller id=1 epoch=28] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:20,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,970] INFO [Controller id=1 epoch=28] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:28) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,985] INFO [Controller id=1 epoch=28] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:36,ZkVersion:52,ControllerEpoch:28) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,985] INFO [Controller id=1 epoch=28] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:28) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,985] INFO [Controller id=1 epoch=28] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:43,ZkVersion:59,ControllerEpoch:28) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,986] INFO [Controller id=1 epoch=28] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:44,ZkVersion:60,ControllerEpoch:28) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,986] INFO [Controller id=1 epoch=28] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:28) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,986] INFO [Controller id=1 epoch=28] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:28) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:33:15,986] INFO [Controller id=1 epoch=28] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-08-10 15:33:15,987] INFO [Controller id=1 epoch=28] Sending UpdateMetadata request to brokers HashSet(1) for 57 partitions (state.change.logger)
[2022-08-10 15:33:15,988] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-08-10 15:33:15,988] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 28 for partition library-events-1 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,989] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 28 for partition library-events-0 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,989] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 28 for partition library-events-2 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:33:15,989] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 28 with correlation id 3 for 0 partitions (state.change.logger)
[2022-08-10 15:33:15,990] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-08-10 15:33:15,993] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 28 with correlation id 4 (state.change.logger)
[2022-08-10 15:33:16,061] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,063] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,064] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,065] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,065] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,066] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,066] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,067] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,067] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,068] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,068] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,069] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,069] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,070] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,070] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,071] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,071] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,071] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,072] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,072] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,072] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,073] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,073] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,074] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,074] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,074] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,075] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,075] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,075] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,076] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,076] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,076] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,076] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,077] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,077] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,077] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,077] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,078] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,078] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,078] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,079] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,079] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,079] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,079] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,080] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,080] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,080] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,081] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,081] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,081] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,081] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,081] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,082] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,082] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,082] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,082] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,082] ERROR [Controller id=1 epoch=28] Controller 1 epoch 28 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:33:16,084] INFO [Controller id=1 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:47:39,330] INFO [Controller id=1 epoch=28] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:47:39,331] INFO [Controller id=1 epoch=28] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 15:47:39,338] INFO [Broker id=1] Handling StopReplica request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2022-08-10 15:48:35,099] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 15:48:35,171] INFO [Controller id=0 epoch=29] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 60 become-follower partitions (state.change.logger)
[2022-08-10 15:48:35,174] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0) for 60 partitions (state.change.logger)
[2022-08-10 15:48:35,213] INFO [Controller id=0 epoch=29] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:36,ZkVersion:52,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,214] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,214] INFO [Controller id=0 epoch=29] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:43,ZkVersion:59,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,215] INFO [Controller id=0 epoch=29] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:44,ZkVersion:60,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,215] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,215] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,248] INFO [Controller id=0 epoch=29] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:37,ZkVersion:53,ControllerEpoch:29) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,249] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,249] INFO [Controller id=0 epoch=29] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:44,ZkVersion:60,ControllerEpoch:29) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,249] INFO [Controller id=0 epoch=29] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:45,ZkVersion:61,ControllerEpoch:29) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,249] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,250] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:35,250] INFO [Controller id=0 epoch=29] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-08-10 15:48:35,250] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
[2022-08-10 15:48:35,361] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 60 partitions (state.change.logger)
[2022-08-10 15:48:35,474] ERROR [Controller id=0 epoch=29] Controller 0 epoch 29 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:48:35,480] ERROR [Controller id=0 epoch=29] Controller 0 epoch 29 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:48:35,480] ERROR [Controller id=0 epoch=29] Controller 0 epoch 29 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:48:35,483] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,483] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,483] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,483] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,483] INFO [Controller id=0 epoch=29] Changed partition test-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,483] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition test-topic-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,484] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,485] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=21, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2022-08-10 15:48:35,486] INFO [Controller id=0 epoch=29] Sending LeaderAndIsr request to broker 0 with 54 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-10 15:48:35,487] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0) for 54 partitions (state.change.logger)
[2022-08-10 15:48:35,509] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-3 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,518] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-18 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,520] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-41 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,524] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-SSL-2 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,526] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-10 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,528] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-33 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,531] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-48 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,536] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-19 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,540] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-34 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,542] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-4 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,544] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-11 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,545] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-26 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,546] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-49 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,547] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-SSL-1 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,547] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-39 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,548] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-9 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,549] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-24 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,550] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-3 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,552] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-31 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,553] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-46 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,554] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-1 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,554] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-16 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,555] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-2 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,555] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-25 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,556] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-40 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,562] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-47 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,563] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-17 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,563] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-32 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,564] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-37 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,565] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-7 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,565] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-22 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,566] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-1 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,567] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-29 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,567] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-44 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,568] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-14 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,568] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition library-events-2 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,569] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-23 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,570] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-2 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,570] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-38 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,571] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-8 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,572] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-45 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,576] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-15 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,577] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-30 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,578] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-0 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,579] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-35 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,579] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-5 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,580] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-20 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,581] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-27 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,581] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-42 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,582] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition library-events-0 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,583] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-12 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,583] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-SSL-0 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,584] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-21 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,585] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition test-topic-0 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,585] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-36 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,586] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-6 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,586] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-43 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,591] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition library-events-1 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,592] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-13 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,592] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 29 for partition __consumer_offsets-28 (last update controller epoch 28) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,598] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 29 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-10 15:48:35,616] INFO [Broker id=0] Finished LeaderAndIsr request in 256ms correlationId 1 from controller 0 for 60 partitions (state.change.logger)
[2022-08-10 15:48:35,635] INFO [Broker id=0] Add 57 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 2 (state.change.logger)
[2022-08-10 15:48:35,641] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:48:35,641] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 29 for partition library-events-1 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,642] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 29 for partition library-events-0 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,642] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 29 for partition library-events-2 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:48:35,642] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 29 with correlation id 3 for 0 partitions (state.change.logger)
[2022-08-10 15:48:35,642] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:48:35,646] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 4 (state.change.logger)
[2022-08-10 15:48:35,649] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 54 partitions (state.change.logger)
[2022-08-10 15:48:35,654] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 29 as part of the become-leader transition for 54 partitions (state.change.logger)
[2022-08-10 15:48:35,659] INFO [Broker id=0] Leader __consumer_offsets-3 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,666] INFO [Broker id=0] Leader __consumer_offsets-18 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,668] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,670] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,672] INFO [Broker id=0] Leader __consumer_offsets-33 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,674] INFO [Broker id=0] Leader __consumer_offsets-48 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,676] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,680] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,682] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,684] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,687] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,688] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,690] INFO [Broker id=0] Leader __consumer_offsets-39 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,693] INFO [Broker id=0] Leader __consumer_offsets-9 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,697] INFO [Broker id=0] Leader __consumer_offsets-24 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,699] INFO [Broker id=0] Leader test-topic-3 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,701] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,703] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,705] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,707] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,708] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,710] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,712] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,714] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,716] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,717] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,719] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,721] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,723] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,725] INFO [Broker id=0] Leader test-topic-1 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,727] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,729] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,731] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,732] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,734] INFO [Broker id=0] Leader test-topic-2 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,736] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,738] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,739] INFO [Broker id=0] Leader __consumer_offsets-45 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,741] INFO [Broker id=0] Leader __consumer_offsets-15 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,743] INFO [Broker id=0] Leader __consumer_offsets-30 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,745] INFO [Broker id=0] Leader __consumer_offsets-0 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,746] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,749] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,751] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,753] INFO [Broker id=0] Leader __consumer_offsets-27 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,755] INFO [Broker id=0] Leader __consumer_offsets-42 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,756] INFO [Broker id=0] Leader __consumer_offsets-12 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,758] INFO [Broker id=0] Leader __consumer_offsets-21 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,760] INFO [Broker id=0] Leader test-topic-0 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,762] INFO [Broker id=0] Leader __consumer_offsets-36 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,763] INFO [Broker id=0] Leader __consumer_offsets-6 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,765] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,767] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,768] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 15:48:35,915] INFO [Broker id=0] Finished LeaderAndIsr request in 266ms correlationId 5 from controller 0 for 54 partitions (state.change.logger)
[2022-08-10 15:48:35,919] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 6 (state.change.logger)
[2022-08-10 15:48:52,833] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,838] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(1) for 57 partitions (state.change.logger)
[2022-08-10 15:48:52,843] INFO [Controller id=0 epoch=29] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-08-10 15:48:52,844] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0, 1) for 6 partitions (state.change.logger)
[2022-08-10 15:48:52,846] INFO [Broker id=0] Add 3 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 8 (state.change.logger)
[2022-08-10 15:48:52,854] ERROR [Controller id=0 epoch=29] Controller 0 epoch 29 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:48:52,854] ERROR [Controller id=0 epoch=29] Controller 0 epoch 29 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:48:52,854] ERROR [Controller id=0 epoch=29] Controller 0 epoch 29 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:48:52,855] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,863] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,863] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,864] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet(0, 1) for 3 partitions (state.change.logger)
[2022-08-10 15:48:52,866] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 9 (state.change.logger)
[2022-08-10 15:48:52,872] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,875] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:52,875] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:52,875] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:52,878] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:52,878] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:52,878] INFO [Controller id=0 epoch=29] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:29) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:48:52,879] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,880] INFO [Controller id=0 epoch=29] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-08-10 15:48:52,881] INFO [Controller id=0 epoch=29] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 15:48:52,883] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:52,883] INFO [Controller id=0 epoch=29] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2022-08-10 15:48:52,883] INFO [Controller id=0 epoch=29] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 15:48:52,883] INFO [Broker id=0] Handling StopReplica request correlationId 10 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:48:52,898] INFO [Broker id=0] Handling StopReplica request correlationId 11 from controller 0 for 3 partitions (state.change.logger)
[2022-08-10 15:48:52,934] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 11 epoch 29 for partition test-topic-SSL-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2022-08-10 15:48:52,935] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 11 epoch 29 for partition test-topic-SSL-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2022-08-10 15:48:52,935] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 0 with correlation id 11 epoch 29 for partition test-topic-SSL-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2022-08-10 15:48:52,940] INFO [Controller id=0 epoch=29] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 15:48:53,241] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 29 with correlation id 0 (state.change.logger)
[2022-08-10 15:49:12,751] INFO [Controller id=1 epoch=30] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2022-08-10 15:49:12,783] INFO [Controller id=1 epoch=30] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2022-08-10 15:49:12,785] INFO [Controller id=1 epoch=30] Sending UpdateMetadata request to brokers HashSet(1) for 6 partitions (state.change.logger)
[2022-08-10 15:49:12,790] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 6 partitions (state.change.logger)
[2022-08-10 15:49:12,846] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 30 for partition library-events-1 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,855] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 30 for partition test-topic-SSL-2 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,860] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 30 for partition library-events-0 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,865] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 30 for partition test-topic-SSL-0 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,867] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 30 for partition library-events-2 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,873] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 30 for partition test-topic-SSL-1 (last update controller epoch 29) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,882] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 30 with correlation id 1 for 0 partitions (state.change.logger)
[2022-08-10 15:49:12,917] INFO [Broker id=1] Finished LeaderAndIsr request in 123ms correlationId 1 from controller 1 for 6 partitions (state.change.logger)
[2022-08-10 15:49:12,925] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,927] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,928] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,929] INFO [Controller id=1 epoch=30] Partition test-topic-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,929] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,929] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,929] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,930] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,930] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,930] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,930] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,930] INFO [Controller id=1 epoch=30] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:37,ZkVersion:53,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,931] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,931] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,931] INFO [Controller id=1 epoch=30] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,931] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,931] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,932] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,932] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,932] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,932] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,932] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,933] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,933] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,933] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,933] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,933] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,933] INFO [Controller id=1 epoch=30] Partition test-topic-3 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,934] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,934] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,934] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,934] INFO [Controller id=1 epoch=30] Partition test-topic-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,934] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,934] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,935] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,935] INFO [Controller id=1 epoch=30] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:44,ZkVersion:60,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,936] INFO [Broker id=1] Add 3 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 30 with correlation id 2 (state.change.logger)
[2022-08-10 15:49:12,937] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,937] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,937] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition test-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:45,ZkVersion:61,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,938] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,939] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,942] INFO [Controller id=1 epoch=30] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,942] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,943] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,943] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,943] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,943] INFO [Controller id=1 epoch=30] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:22,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,943] INFO [Controller id=1 epoch=30] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:30) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,970] INFO [Controller id=1 epoch=30] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:38,ZkVersion:54,ControllerEpoch:30) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,972] INFO [Controller id=1 epoch=30] Partition test-topic-SSL-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:30) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,972] INFO [Controller id=1 epoch=30] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:45,ZkVersion:61,ControllerEpoch:30) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,972] INFO [Controller id=1 epoch=30] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:46,ZkVersion:62,ControllerEpoch:30) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,973] INFO [Controller id=1 epoch=30] Partition test-topic-SSL-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:30) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,973] INFO [Controller id=1 epoch=30] Partition test-topic-SSL-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:30) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 15:49:12,973] INFO [Controller id=1 epoch=30] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2022-08-10 15:49:12,973] INFO [Controller id=1 epoch=30] Sending UpdateMetadata request to brokers HashSet(1) for 57 partitions (state.change.logger)
[2022-08-10 15:49:12,979] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-08-10 15:49:12,979] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 30 for partition library-events-1 (last update controller epoch 30) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,980] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 30 for partition library-events-0 (last update controller epoch 30) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,980] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 30 for partition library-events-2 (last update controller epoch 30) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2022-08-10 15:49:12,982] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 30 with correlation id 3 for 0 partitions (state.change.logger)
[2022-08-10 15:49:12,983] INFO [Broker id=1] Finished LeaderAndIsr request in 5ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2022-08-10 15:49:12,989] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 30 with correlation id 4 (state.change.logger)
[2022-08-10 15:49:13,052] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,055] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,055] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,056] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,056] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition test-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,057] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,057] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,057] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,058] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,058] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,058] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,059] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,059] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition library-events-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,059] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,060] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,060] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,060] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,061] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,061] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,061] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,062] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,062] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,062] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,063] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,063] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,063] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,063] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition test-topic-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,064] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,064] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,064] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,065] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,065] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,065] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,065] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,066] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition library-events-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,066] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,066] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,066] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,067] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,067] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,067] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,067] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,067] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition library-events-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,068] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,068] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,068] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,068] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,069] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,069] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,069] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,069] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,070] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,070] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,070] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,070] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,071] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,071] ERROR [Controller id=1 epoch=30] Controller 1 epoch 30 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 15:49:13,072] INFO [Controller id=1 epoch=30] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:12:29,174] INFO [Controller id=1 epoch=30] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:12:29,177] INFO [Controller id=1 epoch=30] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 16:12:29,183] INFO [Controller id=1 epoch=30] Partition library-events-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:46,ZkVersion:62,ControllerEpoch:30) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 16:12:29,183] INFO [Controller id=1 epoch=30] Partition library-events-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:45,ZkVersion:61,ControllerEpoch:30) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 16:12:29,183] INFO [Controller id=1 epoch=30] Partition library-events-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:38,ZkVersion:54,ControllerEpoch:30) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 16:12:29,184] INFO [Controller id=1 epoch=30] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2022-08-10 16:12:29,184] INFO [Controller id=1 epoch=30] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2022-08-10 16:12:29,192] INFO [Broker id=1] Handling StopReplica request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2022-08-10 16:13:43,563] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 16:14:00,117] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2022-08-10 16:14:00,118] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2022-08-10 16:15:12,572] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1) for 0 partitions (state.change.logger)
[2022-08-10 16:15:12,574] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2022-08-10 16:16:50,491] INFO [Controller id=0 epoch=1] Changed partition test-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2022-08-10 16:16:50,491] INFO [Controller id=0 epoch=1] Changed partition test-topic-1 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2022-08-10 16:16:50,491] INFO [Controller id=0 epoch=1] Changed partition test-topic-2 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2022-08-10 16:16:50,491] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:16:50,496] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:16:50,520] INFO [Controller id=0 epoch=1] Changed partition test-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2022-08-10 16:16:50,520] INFO [Controller id=0 epoch=1] Changed partition test-topic-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2022-08-10 16:16:50,520] INFO [Controller id=0 epoch=1] Changed partition test-topic-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2022-08-10 16:16:50,523] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-10 16:16:50,524] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-10 16:16:50,525] INFO [Controller id=0 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2022-08-10 16:16:50,525] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2022-08-10 16:16:50,529] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:16:50,535] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 2 from controller 0 for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,535] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,535] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,573] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,611] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,644] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 0 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,803] INFO [Broker id=2] Leader test-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 16:16:50,839] INFO [Broker id=2] Finished LeaderAndIsr request in 307ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,853] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 2 (state.change.logger)
[2022-08-10 16:16:50,886] INFO [Broker id=0] Leader test-topic-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 16:16:50,903] INFO [Broker id=0] Finished LeaderAndIsr request in 371ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,918] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 4 (state.change.logger)
[2022-08-10 16:16:50,965] INFO [Broker id=1] Leader test-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2022-08-10 16:16:50,982] INFO [Broker id=1] Finished LeaderAndIsr request in 450ms correlationId 2 from controller 0 for 1 partitions (state.change.logger)
[2022-08-10 16:16:50,993] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 3 (state.change.logger)
[2022-08-10 16:17:18,811] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:17:18,994] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:17:19,018] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 16:17:19,022] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:17:19,039] INFO [Controller id=0 epoch=1] Partition test-topic-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 16:17:19,042] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2022-08-10 16:17:19,045] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 4 (state.change.logger)
[2022-08-10 16:17:19,046] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 5 (state.change.logger)
[2022-08-10 16:17:24,748] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:17:24,917] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:17:24,922] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 16:17:24,923] ERROR [Controller id=0 epoch=1] Controller 0 epoch 1 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-08-10 16:17:24,923] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2022-08-10 16:17:24,927] INFO [Controller id=0 epoch=1] Partition test-topic-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2022-08-10 16:17:24,927] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2022-08-10 16:17:24,928] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 1 with correlation id 6 (state.change.logger)
[2022-08-10 16:17:30,377] INFO [Controller id=0 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:47:19,422] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-01-21 22:47:19,484] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 22:47:19,490] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2024-01-21 22:47:19,532] INFO [Controller id=0 epoch=2] Partition test-topic-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 22:47:19,547] INFO [Controller id=0 epoch=2] Partition test-topic-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 22:47:19,549] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 2 partitions (state.change.logger)
[2024-01-21 22:47:19,616] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:47:19,617] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 22:47:19,625] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 22:47:19,628] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:47:19,672] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 22:47:19,701] INFO [Broker id=0] Leader test-topic-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:47:19,724] INFO [Broker id=0] Finished LeaderAndIsr request in 110ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:47:19,737] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2024-01-21 22:47:19,740] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 3 (state.change.logger)
[2024-01-21 22:54:17,159] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-01-21 22:54:17,166] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2024-01-21 22:54:17,170] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 22:54:17,170] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,187] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 5 (state.change.logger)
[2024-01-21 22:54:17,188] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 22:54:17,189] INFO [Controller id=0 epoch=2] Changed partition test-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=3, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=3) (state.change.logger)
[2024-01-21 22:54:17,189] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 22:54:17,189] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,198] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 6 (state.change.logger)
[2024-01-21 22:54:17,583] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 0 (state.change.logger)
[2024-01-21 22:54:17,605] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,637] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 2 for partition test-topic-1 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-01-21 22:54:17,648] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 1 for 0 partitions (state.change.logger)
[2024-01-21 22:54:17,663] INFO [Broker id=1] Finished LeaderAndIsr request in 60ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,671] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2024-01-21 22:54:17,674] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,681] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,689] INFO [Broker id=1] Leader test-topic-1 starts at leader epoch 3 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:54:17,700] INFO [Broker id=1] Finished LeaderAndIsr request in 26ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:17,705] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 4 (state.change.logger)
[2024-01-21 22:54:45,630] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1) for 0 partitions (state.change.logger)
[2024-01-21 22:54:45,631] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(2) for 3 partitions (state.change.logger)
[2024-01-21 22:54:45,631] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 22:54:45,632] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-01-21 22:54:45,641] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 8 (state.change.logger)
[2024-01-21 22:54:45,643] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 6 (state.change.logger)
[2024-01-21 22:54:45,649] INFO [Controller id=0 epoch=2] Changed partition test-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=3, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=3) (state.change.logger)
[2024-01-21 22:54:45,649] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 22:54:45,650] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-01-21 22:54:45,653] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 7 (state.change.logger)
[2024-01-21 22:54:45,653] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 9 (state.change.logger)
[2024-01-21 22:54:46,063] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 0 (state.change.logger)
[2024-01-21 22:54:46,085] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:46,114] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 2 for partition test-topic-0 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-01-21 22:54:46,130] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 1 for 0 partitions (state.change.logger)
[2024-01-21 22:54:46,147] INFO [Broker id=2] Finished LeaderAndIsr request in 64ms correlationId 1 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:46,157] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 2 (state.change.logger)
[2024-01-21 22:54:46,159] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:46,164] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 22:54:46,172] INFO [Broker id=2] Leader test-topic-0 starts at leader epoch 3 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:54:46,183] INFO [Broker id=2] Finished LeaderAndIsr request in 24ms correlationId 3 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 22:54:46,190] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 4 (state.change.logger)
[2024-01-21 22:55:13,683] INFO [Controller id=0 epoch=2] Changed partition library-events-0 state from NonExistentPartition to NewPartition with assigned replicas 2,1,0 (state.change.logger)
[2024-01-21 22:55:13,684] INFO [Controller id=0 epoch=2] Changed partition library-events-1 state from NonExistentPartition to NewPartition with assigned replicas 1,0,2 (state.change.logger)
[2024-01-21 22:55:13,684] INFO [Controller id=0 epoch=2] Changed partition library-events-2 state from NonExistentPartition to NewPartition with assigned replicas 0,2,1 (state.change.logger)
[2024-01-21 22:55:13,684] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:55:13,686] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:55:13,711] INFO [Controller id=0 epoch=2] Changed partition library-events-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 1, 0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:55:13,711] INFO [Controller id=0 epoch=2] Changed partition library-events-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 0, 2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:55:13,711] INFO [Controller id=0 epoch=2] Changed partition library-events-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 2, 1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:55:13,711] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-01-21 22:55:13,711] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-01-21 22:55:13,712] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-01-21 22:55:13,712] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-01-21 22:55:13,713] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:55:13,713] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 10 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 22:55:13,714] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 22:55:13,715] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 8 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 22:55:13,734] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 8 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 22:55:13,737] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 22:55:13,740] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 10 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 22:55:13,798] INFO [Broker id=0] Leader library-events-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,2,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,809] INFO [Broker id=1] Leader library-events-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,0,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,810] INFO [Broker id=2] Leader library-events-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,1,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,853] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,885] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,885] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,889] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 10 for 2 partitions (state.change.logger)
[2024-01-21 22:55:13,892] INFO [Broker id=2] Follower library-events-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,931] INFO [Broker id=2] Follower library-events-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,931] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 5 for 2 partitions (state.change.logger)
[2024-01-21 22:55:13,957] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:55:13,960] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 8 for 2 partitions (state.change.logger)
[2024-01-21 22:55:14,101] INFO [Broker id=0] Finished LeaderAndIsr request in 387ms correlationId 10 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 22:55:14,106] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 11 (state.change.logger)
[2024-01-21 22:55:14,121] INFO [Broker id=2] Finished LeaderAndIsr request in 406ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 22:55:14,130] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 6 (state.change.logger)
[2024-01-21 22:55:14,499] INFO [Broker id=1] Finished LeaderAndIsr request in 784ms correlationId 8 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 22:55:14,503] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 9 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-22 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-30 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-25 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-35 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-37 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-38 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,319] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-13 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,321] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-8 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-21 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-4 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-27 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-7 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-9 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-46 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-41 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-33 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-23 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-49 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-47 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-16 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-28 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-31 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-36 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-42 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-3 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-18 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-15 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-24 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-17 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-48 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-19 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-11 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-2 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-43 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-6 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-14 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-20 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,323] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-44 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-39 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-12 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-45 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-1 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-5 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-26 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-29 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-34 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-10 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-32 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-40 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-01-21 22:59:06,324] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:59:06,325] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-22 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-30 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-25 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-35 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-37 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-38 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-13 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-8 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-21 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-27 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-7 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-9 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-46 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-41 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-33 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-23 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-49 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-47 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-16 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,460] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-28 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-31 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-36 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-42 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-18 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-15 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-24 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-17 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-48 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-19 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-11 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-43 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-6 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-14 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-20 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-44 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-39 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,461] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-12 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-45 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-26 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-29 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-34 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-10 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-32 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Changed partition __consumer_offsets-40 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 22:59:06,462] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 22:59:06,463] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 12 from controller 0 for 17 partitions (state.change.logger)
[2024-01-21 22:59:06,463] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 10 from controller 0 for 17 partitions (state.change.logger)
[2024-01-21 22:59:06,498] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 10 from controller 0 epoch 2 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-01-21 22:59:06,519] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 22:59:06,520] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 50 partitions (state.change.logger)
[2024-01-21 22:59:06,529] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 22:59:06,536] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 7 from controller 0 for 16 partitions (state.change.logger)
[2024-01-21 22:59:06,711] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 12 from controller 0 epoch 2 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-01-21 22:59:06,711] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 0 epoch 2 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-01-21 22:59:06,778] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,788] INFO [Broker id=2] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,790] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,811] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,813] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,842] INFO [Broker id=2] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,874] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,874] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,875] INFO [Broker id=2] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,907] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,911] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:06,922] INFO [Broker id=2] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,011] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,017] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,027] INFO [Broker id=2] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,095] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,108] INFO [Broker id=2] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,120] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,148] INFO [Broker id=2] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,173] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,174] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,199] INFO [Broker id=2] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,250] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,266] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,266] INFO [Broker id=2] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,312] INFO [Broker id=2] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,330] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,331] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,356] INFO [Broker id=2] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,361] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,362] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,395] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,414] INFO [Broker id=2] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,423] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,426] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,462] INFO [Broker id=2] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,500] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,506] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,526] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,543] INFO [Broker id=2] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,550] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,558] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,569] INFO [Broker id=2] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,583] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,610] INFO [Broker id=2] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,621] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,621] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,669] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,751] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,762] INFO [Broker id=2] Finished LeaderAndIsr request in 1226ms correlationId 7 from controller 0 for 16 partitions (state.change.logger)
[2024-01-21 22:59:07,768] INFO [Broker id=2] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 8 (state.change.logger)
[2024-01-21 22:59:07,787] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-01-21 22:59:07,815] INFO [Broker id=1] Finished LeaderAndIsr request in 1352ms correlationId 10 from controller 0 for 17 partitions (state.change.logger)
[2024-01-21 22:59:07,820] INFO [Broker id=1] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 11 (state.change.logger)
[2024-01-21 22:59:07,839] INFO [Broker id=0] Finished LeaderAndIsr request in 1376ms correlationId 12 from controller 0 for 17 partitions (state.change.logger)
[2024-01-21 22:59:07,848] INFO [Broker id=0] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 13 (state.change.logger)
[2024-01-21 23:43:00,464] INFO [Controller id=0 epoch=2] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=1, isr=List(1, 0), leaderRecoveryState=RECOVERED, zkVersion=1) (state.change.logger)
[2024-01-21 23:43:00,465] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,466] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,466] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,466] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,469] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:00,471] INFO [Controller id=0 epoch=2] Sending StopReplica request for 2 replicas to broker 2 (state.change.logger)
[2024-01-21 23:43:00,477] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 14 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,478] INFO [Broker id=0] Follower library-events-0 starts at leader epoch 1 from offset 3 with high watermark 3. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,480] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,482] INFO [Broker id=2] Follower library-events-0 starts at leader epoch 1 from offset 3 with high watermark 3. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,483] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 9 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,478] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 12 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,484] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 14 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,487] INFO [Controller id=0 epoch=2] Partition library-events-1 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,488] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,489] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,489] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,489] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-01-21 23:43:00,490] INFO [Controller id=0 epoch=2] Sending StopReplica request for 2 replicas to broker 2 (state.change.logger)
[2024-01-21 23:43:00,491] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 12 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,494] INFO [Broker id=1] Leader library-events-0 starts at leader epoch 1 from offset 3 with high watermark 3 ISR [1,0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,497] INFO [Broker id=2] Finished LeaderAndIsr request in 18ms correlationId 9 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,499] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 10 (state.change.logger)
[2024-01-21 23:43:00,503] INFO [Broker id=0] Finished LeaderAndIsr request in 26ms correlationId 14 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,503] INFO [Broker id=2] Handling StopReplica request correlationId 11 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:00,505] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 15 (state.change.logger)
[2024-01-21 23:43:00,507] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 16 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:00,510] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 16 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,510] INFO [Broker id=0] Leader library-events-2 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0,1] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,538] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 2 for partition library-events-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,538] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 11 epoch 2 for partition library-events-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,562] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 16 from controller 0 epoch 2 for partition library-events-2 (last update controller epoch 2) since it is already the leader for the partition. (state.change.logger)
[2024-01-21 23:43:00,562] INFO [Broker id=0] Follower library-events-1 starts at leader epoch 1 from offset 2 with high watermark 2. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,585] INFO [Broker id=1] Finished LeaderAndIsr request in 107ms correlationId 12 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,590] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 16 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,590] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 13 (state.change.logger)
[2024-01-21 23:43:00,596] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 14 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:00,599] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 14 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,600] INFO [Broker id=1] Leader library-events-1 starts at leader epoch 1 from offset 2 with high watermark 2 ISR [1,0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,602] INFO [Broker id=0] Finished LeaderAndIsr request in 95ms correlationId 16 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:00,607] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 17 (state.change.logger)
[2024-01-21 23:43:00,615] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 14 from controller 0 epoch 2 for partition library-events-1 (last update controller epoch 2) since it is already the leader for the partition. (state.change.logger)
[2024-01-21 23:43:00,616] INFO [Broker id=1] Follower library-events-2 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2024-01-21 23:43:00,619] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 14 for 1 partitions (state.change.logger)
[2024-01-21 23:43:00,625] INFO [Broker id=1] Finished LeaderAndIsr request in 31ms correlationId 14 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:00,627] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 15 (state.change.logger)
[2024-01-21 23:43:00,839] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:00,856] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,857] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,857] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,857] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,858] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,858] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,858] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,859] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,859] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,859] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,859] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,859] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,859] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,860] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,860] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,860] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,860] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:00,861] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:00,885] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,885] INFO [Controller id=0 epoch=2] Partition library-events-0 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,885] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:0,ISR:0,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition test-topic-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition library-events-1 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:00,886] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,887] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-01-21 23:43:00,887] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1) for 20 partitions (state.change.logger)
[2024-01-21 23:43:00,888] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 18 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 23:43:00,890] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 18 epoch 2 for partition library-events-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,890] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 18 epoch 2 for partition library-events-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,890] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 18 epoch 2 for partition library-events-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,890] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 16 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 23:43:00,891] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 18 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 23:43:00,893] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 19 (state.change.logger)
[2024-01-21 23:43:00,893] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 2 for partition library-events-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,894] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 2 for partition library-events-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,894] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 2 for partition library-events-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:00,895] INFO [Broker id=1] Finished LeaderAndIsr request in 4ms correlationId 16 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 23:43:00,899] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 17 (state.change.logger)
[2024-01-21 23:43:10,861] INFO [Controller id=0 epoch=2] Changed partition library-events-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-01-21 23:43:10,861] INFO [Controller id=0 epoch=2] Changed partition library-events-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-01-21 23:43:10,861] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 23:43:10,861] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 2 become-follower partitions (state.change.logger)
[2024-01-21 23:43:10,861] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1) for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,862] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:10,862] INFO [Controller id=0 epoch=2] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-01-21 23:43:10,863] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 20 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,864] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 18 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,864] INFO [Broker id=1] Follower library-events-1 starts at leader epoch 2 from offset 2 with high watermark 2. Previous leader epoch was 1. (state.change.logger)
[2024-01-21 23:43:10,865] INFO [Broker id=1] Follower library-events-0 starts at leader epoch 2 from offset 3 with high watermark 3. Previous leader epoch was 1. (state.change.logger)
[2024-01-21 23:43:10,867] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 2 with correlation id 18 for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,873] INFO [Broker id=1] Finished LeaderAndIsr request in 9ms correlationId 18 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,876] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 19 (state.change.logger)
[2024-01-21 23:43:10,876] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 20 from controller 0 epoch 2 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,876] INFO [Broker id=0] Leader library-events-1 starts at leader epoch 2 from offset 2 with high watermark 2 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2024-01-21 23:43:10,879] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:10,879] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 23:43:10,879] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1) for 1 partitions (state.change.logger)
[2024-01-21 23:43:10,879] INFO [Broker id=1] Handling StopReplica request correlationId 20 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:10,879] INFO [Controller id=0 epoch=2] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-01-21 23:43:10,879] INFO [Broker id=0] Leader library-events-0 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2024-01-21 23:43:10,887] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 0 with correlation id 20 epoch 2 for partition library-events-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:10,922] INFO [Broker id=0] Finished LeaderAndIsr request in 59ms correlationId 20 from controller 0 for 2 partitions (state.change.logger)
[2024-01-21 23:43:10,924] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 21 (state.change.logger)
[2024-01-21 23:43:10,924] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 22 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:10,926] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 22 from controller 0 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-01-21 23:43:10,927] INFO [Broker id=0] Leader library-events-2 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 1. (state.change.logger)
[2024-01-21 23:43:10,931] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 22 from controller 0 epoch 2 for partition library-events-2 (last update controller epoch 2) since it is already the leader for the partition. (state.change.logger)
[2024-01-21 23:43:10,932] INFO [Broker id=0] Finished LeaderAndIsr request in 8ms correlationId 22 from controller 0 for 1 partitions (state.change.logger)
[2024-01-21 23:43:10,934] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 23 (state.change.logger)
[2024-01-21 23:43:11,116] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:11,132] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,132] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,132] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,133] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition test-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,134] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,135] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,136] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,136] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,136] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition test-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition test-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,136] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,136] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,137] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,138] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,138] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,138] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,138] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:11,138] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition test-topic-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition library-events-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition library-events-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,160] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Controller id=0 epoch=2] Partition library-events-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Controller id=0 epoch=2] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Controller id=0 epoch=2] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 21 partitions (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 24 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 24 epoch 2 for partition library-events-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 24 epoch 2 for partition library-events-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 24 epoch 2 for partition library-events-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-01-21 23:43:11,161] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 24 from controller 0 for 3 partitions (state.change.logger)
[2024-01-21 23:43:11,162] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 25 (state.change.logger)
[2024-01-21 23:43:20,830] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:20,830] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:20,830] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:20,831] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:20,831] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:25,845] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:25,845] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:25,845] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:25,845] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:25,845] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:31,230] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:31,230] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:31,230] ERROR [Controller id=0 epoch=2] Controller 0 epoch 2 failed to change state for partition library-events-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition library-events-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-01-21 23:43:31,230] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-01-21 23:43:31,230] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
